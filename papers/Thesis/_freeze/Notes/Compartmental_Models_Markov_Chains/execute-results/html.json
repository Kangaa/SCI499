{
  "hash": "d965e94e330ba6c73bd1cd23ee3bfae2",
  "result": {
    "markdown": "# SIS DTMC\n\nThe compartmental model\n\n```{mermaid}\nflowchart LR\n    S --> I\n    I --> S\n```\n\nCan be described by a Markov chain of a random variable I(t) representing the number of individuals infected at time t.\n\n\n\n```{dot}\ndigraph {\n    rankdir = \"LR\"\n    0 -> 0\n    1 -> 0\n    1 -> 2\n    2 -> 1\n    2 -> \"...\"\n    \"...\" -> 2\n    \"...\" -> N\n    N -> \"...\"\n}   \n```\n\nNote that I(t) = 0 is an absorbing state (i.e. if there are no infectious people they cannot infect anyone). All other states {1,..., N} are transient. \n\nPossible transitions are specified by\n\n$$\np _ {ji} ( \\Delta t ) =\n     \\begin{cases}\n        {\\frac { \\beta i ( N - i ) } { N}} \\Delta t, & {j = i + 1 } \\\\ \n        { \\gamma i \\Delta t}, & { j = i - 1 } \\\\ \n        { 1 - \\bigg[ \\frac { \\beta i (N - i) } { N } +  \\gamma i }\\bigg] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n$$ {#eq-SIS_DTMC_Trans} \n\nWhich can be simplified to\n\n$$\np _ {ji} ( \\Delta t ) =\n    \\begin{cases}\n        b(i) \\Delta t, & {j = i + 1 } \\\\ \n        d(i) \\Delta t, & { j = i - 1 } \\\\ \n        1 - [ b(i)  + d(i)] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n$$ {#eq-SIS_DTMC_Trans_BD}\n\nThe probability of being in state $i$ at time $t + \\Delta t$ can be experessed in terms of probabilities at time $t$.\n$$\np_{i}(t + \\Delta t) =\n    p_{i-1}(t)b(i-1)\\Delta t +\n    p_{i+1}(t)d(i+1)\\Delta t +\n    p_{i}(t)(1- [ b(i)  + d(i)] \\Delta t)\n$$ \n\nfor $i = 1,2,..., N$, where $b(i) = \\beta (N-1/N)$, and $d(i)= \\gamma i$\n\nThe transition matrix $P(\\Delta t)$ is given by\n$$\n\\begin{pmatrix}\n    1 & d(1)\\Delta t & 0 &  \\cdots & 0 & 0 \\\\\n    0  & 1-(b+d)(1)\\Delta t & d(2)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & b(1)\\Delta t & 1-(b+d)(1)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & 0t & b(1)\\Delta &  \\cdots & 0 & 0 \\\\\n    \\vdots & \\vdots & \\vdots &  \\ddots & \\vdots & \\vdots \\\\\n    0 & 0  & 0 &  \\cdots & d(N-1) \\Delta t & 0 \\\\\n    0 & 0  & 0 &  \\cdots & 1-(b+d)(N-1)\\Delta t & d(N) \\Delta t \\\\\n    0 & 0  & 0 &  \\cdots & b(N-1)\\Delta t & 1- d(N) \\Delta t \\\\\n\\end{pmatrix}\n$$\n\n\n# SIR DTMC\n\nThe compartmental model\n\n```{mermaid}\nflowchart LR\n    S --> I\n    I --> R\n```\n\nCan be described by a Markov chain of two independent random variables S(t) and I(t) representing the number of susceptible or individuals infected at time t, respectively (a third RV R(t) denoting the number of recovered individuals is fully determined when the population size is known, i.e. R = N - S - I).\n\n\n$$\np _ {(s +k, i +j),(s,i)}(\\Delta t) =\n     \\begin{cases}\n        {\\frac { \\beta i s} { N}} \\Delta t, & {(k, j) = (-1, 1) } \\\\ \n        { \\gamma i \\Delta t}, & { (k, j) = (0, -1)  } \\\\ \n        { 1 - \\bigg[ \\frac { \\beta i s } { N } +  \\gamma i }\\bigg] \\Delta t, & { (k, j) = (0, 0)} \\\\\n        0, & {otherwise}\n    \\end{cases}\n$$ {#eq-SIR_DTMC_Trans} \n\n@eq-SIS_DTMC_Trans\n\n```{dot}\ndigraph {\n    rankdir = \"TB\"\n\n    \"S = 0 \\n I = 1\" ->    \"S = 0 \\n I = 0\" [color = \"blue\"]\n    \"S = 0 \\n I = 2\" ->    \"S = 0 \\n I = 1\" [color = \"blue\"]\n    \"S = 0 \\n I = ~\" ->    \"S = 0 \\n I = 2\" [color = \"blue\"]\n    \"S = 0 \\n I = N\" ->    \"S = 0 \\n I = N - 1\" [color = \"blue\"]\n    \"S = 0 \\n I = N - 1\" -> \"S = 0 \\n I = N - 2\" [color = \"blue\"]\n    \"S = 0 \\n I = N - 2\" -> \"S = 0 \\n I = ~\" [color = \"blue\"]\n\n    \"S = 1 \\n I = 1\" ->    \"S = 0 \\n I = 2\"  [color = \"red\"]\n\n    \"S = 1 \\n I = 2\" ->    \"S = 1 \\n I = 1\" [color = \"blue\"]\n    \"S = 1 \\n I = 2\" ->    \"S = 0 \\n I = ~\" [color = \"red\"]\n\n    \"S = 1 \\n I = ~\" ->    \"S = 1 \\n I = 2\" [color = \"blue\"]\n    \"S = 1 \\n I = ~\" ->    \"S = 0 \\n I = ~\" [color = \"red\"]\n    \"S = 1 \\n I = ~\" ->    \"S = 0 \\n I = N - 1\" [color = \"red\"]\n\n    \"S = 1 \\n I = N - 1\" -> \"S = 1 \\n I = N - 2\" [color = \"blue\"]\n    \"S = 1 \\n I = N - 1\" -> \"S = 0 \\n I = N\" [color = \"red\"]\n\n    \"S = 1 \\n I = N - 2\" -> \"S = 0 \\n I = N - 1\" [color = \"red\"]\n    \"S = 1 \\n I = N - 2\" -> \"S = 1 \\n I = ~\" [color = \"blue\"]\n\n\n    \"S = 2 \\n I = 1\" ->    \"S = 1 \\n I = 2\" [color = \"red\"]\n    \"S = 2 \\n I = 1\" ->    \"S = 2 \\n I = 0\" [color = \"blue\"]\n\n    \"S = 2 \\n I = 2\" ->    \"S = 1 \\n I = ~\" [color = \"red\"]\n    \"S = 2 \\n I = 2\" ->    \"S = 2 \\n I = 1\" [color = \"blue\"]\n\n    \"S = 2 \\n I = ~\" ->    \"S = 1 \\n I = ~\" [color = \"red\"]\n    \"S = 2 \\n I = ~\" ->    \"S = 1 \\n I = N - 2\" [color = \"red\"]\n    \"S = 2 \\n I = ~\" ->    \"S = 2 \\n I = 2\" [color = \"blue\"]\n\n    \"S = 2 \\n I = N - 2\" -> \"S = 1 \\n I = N - 1\" [color = \"red\"]\n    \"S = 2 \\n I = N - 2\" -> \"S = 2 \\n I = ~\" [color = \"blue\"]\n    \n\n    \"S = ~ \\n I = 1\" ->    \"S = ~ \\n I = 0\" [color = \"blue\"]\n    \"S = ~ \\n I = 1\" ->    \"S = ~ \\n I = 2\" [color = \"red\"]\n    \"S = ~ \\n I = 1\" ->    \"S = 2 \\n I = 2\" [color = \"red\"]\n\n    \"S = ~ \\n I = 2\" ->    \"S = ~ \\n I = ~\" [color = \"red\"]\n    \"S = ~ \\n I = 2\" ->    \"S = 2 \\n I = ~\"  [color = \"red\"]\n    \"S = ~ \\n I = 2\" ->    \"S = ~ \\n I = 1\" [color = \"blue\"]\n\n    \"S = ~ \\n I = ~\" ->    \"S = 2 \\n I = ~\" [color = \"red\"]\n    \"S = ~ \\n I = ~\" ->    \"S = 2 \\n I = N - 2\" [color = \"red\"]\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = ~\"  [color = \"red\"]\n\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = ~\"  [color = \"blue\"]\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = 2\" [color = \"blue\"]\n\n\n    \"S = N - 1 \\n I = 1\" ->    \"S = N - 2 \\n I = 2\" [color = \"red\"]\n    \"S = N - 1 \\n I = 1\" ->    \"S = N - 1\\n I = 0\"   [color = \"blue\"]\n\n    \"S = N - 2 \\n I = 1\" -> \"S = ~ \\n I = 2\" [color = \"red\"]\n    \"S = N - 2 \\n I = 1\" -> \"S = N - 2 \\n I = 0\" [color = \"blue\"]\n\n    \"S = N - 2 \\n I = 2\" -> \"S = ~ \\n I = ~\" [color = \"red\"]\n    \"S = N - 2 \\n I = 2\" -> \"S = N - 2 \\n I = 1\" [color = \"blue\"]\n}   \n```\n\n\n\nThere are (N + 1)(N + 2)/2 ordered pairs of states (s, i)\n\n::: {.cell execution_count=1}\n``` {.julia .cell-code}\nN = 100\nS = 0:N\nI = 0:N\n\nn = Int64((N+1)*(N+2)/2)\n\na = Base.product(S, I) |>  collect |> vec\nb = []\n\nfor i in a\n    if sum(i) <= N\n        push!(b, i)\n    end\nend\n```\n:::\n\n\n::: {.cell execution_count=2}\n``` {.julia .cell-code}\nusing NamedArrays\n\nnames = repr.(b)\n\np = NamedArray(fill(0, (n,n)), (names,names))\n\ntf = function(i, j,  param, N)\n    β, γ = param\n\n    iS, iI = i\n    jS, jI = j\n\n    if iS - jS == 1 && iI - jI == -1 ## Infection condition\n        pij = β*iS*iI/N\n    elseif  iS == jS  && iI - jI == 1\n        pij = γ*iI\n    elseif  iS == jS  && iI == jI \n        pij = - (β*iS*iI/N + γ*iI)\n    else \n        pij = 0.0\n    end\n    pij::Float64\nend\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n#11 (generic function with 1 method)\n```\n:::\n:::\n\n\n::: {.cell execution_count=3}\n``` {.julia .cell-code}\nQ = [tf(i, j, [.5,.1], 100) for i = b, j = b]\nt = 25\nQt = Q*t\n\np0 = falses(lastindex(b))\np0[201] = 1\npt = exp(Qt)*p0\nusing ExponentialUtilities\npt2 = expv(t, Q, p0)\npt2[201]\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n3.4663274126619643e-7\n```\n:::\n:::\n\n\n",
    "supporting": [
      "Compartmental_Models_Markov_Chains_files\\figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}