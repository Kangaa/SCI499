[
  {
    "objectID": "Notes/CTMC_SIR_Sim.html",
    "href": "Notes/CTMC_SIR_Sim.html",
    "title": "4  Gillespie simulation",
    "section": "",
    "text": "To begin, lets define the disease model.\nThe SIR compartmental model features 3 compartiments (Susceptible, Infectious, and Recovered) though which N individuals pass between (i.e. S + I + R = N) over time. To impliment this, lets define a type to represent the state of an SIR system at time t, X(t) = \\{S, I, R\\}.\n\n\nNamedTuple{(:t, :S, :I, :R), Tuple{Real, Int64, Int64, Int64}}\n\n\n\n\n\n\n\n\n\nSIR\n\n  \n\nS\n\n S   \n\nI\n\n I   \n\nS->I\n\n    \n\nR\n\n R   \n\nI->R\n\n   \n\n\n\n\n\nLets initialise a population of N = 100 individuals, one of who is infected and the remaining 99 are Susceptible along with a data frame to record the state at time t = 0.\n\n\n\n1×4 DataFrameRowtSIRFloat64Int64Int64Int6410.09910\n\n\nIn an SIR system there are two possible events that can occur after a certain time \\Delta t: infection (i.e. an individual moves from the Susceptible compartment to the Infectious compartment) X(t + \\Delta t) = \\{s-1, i + 1, r\\} and recovery X(t + \\Delta t) = \\{s, i-1, r +1\\}. Lets define these as triples which we can add to our SIR_State variable\n\n\n(infection = [-1, 1, 0], recovery = [0, -1, 1])\n\n\nOnly one eveCTMC model of a SIR disease process. which event will occur? Epidemiologcal theory tells us that, assuming homogenous mixing of infectious and susceptible individuals there will be S \\times I opportunities for contact. Only a proportion of these opporunities will result in infection, so let the parameter \\beta, the ‘transmission rate’ modulate this.\n\n\n(β = 0.5, γ = 0.1)\n\n\nSimiularly, we’ll specify a constant parameter, \\lambda, which will modulate the rate of recovery. Lets define a ‘transition’ function which, given a state X(t) = \\{s, i,r\\} will return the ‘propensity’ of each event occurring\nOk thats enough setting up, lets simulate the evolution of the system throrugh time.\nDelta t will have an exponential distribution with parameter 1/\\sum{a+b}\n\n\n0.5973480865552511\n\n\nNext we need to determine which event will happen. The probability of a transition will be given by the proportion of the\n\n\n0.16806722689075632\n\n\nTo sample one event with probability weighting according to its relative propensity,\n\n\n\n2×4 DataFrameRowtSIRFloat64Int64Int64Int6410.0991020.5973489901\n\n\nWe’re going to want to run this stepping process a number of times, so lets repeat the process until some specified time (t_{end}) is reached\nlets plot the results for a clearer picture\n\n\n\n\n\nThe probability that a susceptible individual will become infected p_{s-1, i+1}\\leftarrow{s, i} = \\frac\nSince R = S+I -N, se can represent the state of the system with \\{S, I\\}, where S \\in \\{0,1, ... , N-I-R\\}, I \\in \\{0,1, ... , N-S-R\\}.\nfor example, when N = 3, we can represent the system with a graph:\nAs a discrete time process this Markov chain can be represented by the transition matrix \np = \\begin{bmatrix}\n\\end{bmatrix}\n\nlooks reasonable. How about in comparison to the deterministic ODE solution\n\n\n\n\n\nThey’re not identical but maybe this is to be expected given the small sample size. We could inrease the sample size (which extended to would equal the ODE), but lets instead perform the N = 100 simulation a few more times.\nFor convenience I’ll wrap the whole simulation in a function which takes initial conditions and parameters in and outputs the data\n\n\nSIR_sim (generic function with 1 method)\n\n\nand run this 100 times\nI’ll also remove any samples in which the epidemic does not spread (i.e. when i = 0 and s != 0)\n\n\n\n\n\nTo summarise our data, it will be useful to be able to produce the distribution of states (across a number of samples) at a particular time t. I’ll write a function to do this\n\n\n#46 (generic function with 1 method)\n\n\nWe can use this function to define an average over all the our samples throught the course of the simulation.\n\n\n\n\n\nWe can also check the distribution of states at any given time. lets check t = 15\n\n\n\n\n\nA nice snapshot, but maybe we should animate the progression\n\n\n[ Info: Saved animation to C:\\Users\\Reubender\\Documents\\Projects\\SCI499\\papers\\Thesis\\Notes\\tmp.gif\n\n\n\n\n\n\n\n[ Info: Saved animation to C:\\Users\\Reubender\\Documents\\Projects\\SCI499\\papers\\Thesis\\Notes\\tmp.gif"
  },
  {
    "objectID": "Notes/Compartmental_Models_Markov_Chains.html",
    "href": "Notes/Compartmental_Models_Markov_Chains.html",
    "title": "3  SIS DTMC",
    "section": "",
    "text": "flowchart LR\n    S --> I\n    I --> S\n\n\n\n\n\n\n\n\nCan be described by a Markov chain of a random variable I(t) representing the number of individuals infected at time t.\n\n\n\n\n\n   \n\n0\n\n 0   \n\n0->0\n\n    \n\n1\n\n 1   \n\n1->0\n\n    \n\n2\n\n 2   \n\n1->2\n\n    \n\n2->1\n\n    \n\n…\n\n …   \n\n2->…\n\n    \n\n…->2\n\n    \n\nN\n\n N   \n\n…->N\n\n    \n\nN->…\n\n   \n\n\n\n\n\nNote that I(t) = 0 is an absorbing state (i.e. if there are no infectious people they cannot infect anyone). All other states {1,…, N} are transient.\nPossible transitions are specified by\n\np _ {ji} ( \\Delta t ) =\n     \\begin{cases}\n        {\\frac { \\beta i ( N - i ) } { N}} \\Delta t, & {j = i + 1 } \\\\\n        { \\gamma i \\Delta t}, & { j = i - 1 } \\\\\n        { 1 - \\bigg[ \\frac { \\beta i (N - i) } { N } +  \\gamma i }\\bigg] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n\\tag{3.1}\nWhich can be simplified to\n\np _ {ji} ( \\Delta t ) =\n    \\begin{cases}\n        b(i) \\Delta t, & {j = i + 1 } \\\\\n        d(i) \\Delta t, & { j = i - 1 } \\\\\n        1 - [ b(i)  + d(i)] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n\\tag{3.2}\nThe probability of being in state i at time t + \\Delta t can be experessed in terms of probabilities at time t. \np_{i}(t + \\Delta t) =\n    p_{i-1}(t)b(i-1)\\Delta t +\n    p_{i+1}(t)d(i+1)\\Delta t +\n    p_{i}(t)(1- [ b(i)  + d(i)] \\Delta t)\n\nfor i = 1,2,..., N, where b(i) = \\beta (N-1/N), and d(i)= \\gamma i\nThe transition matrix P(\\Delta t) is given by \n\\begin{pmatrix}\n    1 & d(1)\\Delta t & 0 &  \\cdots & 0 & 0 \\\\\n    0  & 1-(b+d)(1)\\Delta t & d(2)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & b(1)\\Delta t & 1-(b+d)(1)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & 0t & b(1)\\Delta &  \\cdots & 0 & 0 \\\\\n    \\vdots & \\vdots & \\vdots &  \\ddots & \\vdots & \\vdots \\\\\n    0 & 0  & 0 &  \\cdots & d(N-1) \\Delta t & 0 \\\\\n    0 & 0  & 0 &  \\cdots & 1-(b+d)(N-1)\\Delta t & d(N) \\Delta t \\\\\n    0 & 0  & 0 &  \\cdots & b(N-1)\\Delta t & 1- d(N) \\Delta t \\\\\n\\end{pmatrix}\n\n\n4 SIR DTMC\nThe compartmental model\n\n\n\n\nflowchart LR\n    S --> I\n    I --> R\n\n\n\n\n\n\n\n\nCan be described by a Markov chain of two independent random variables S(t) and I(t) representing the number of susceptible or individuals infected at time t, respectively (a third RV R(t) denoting the number of recovered individuals is fully determined when the population size is known, i.e. R = N - S - I).\n\np _ {(s +k, i +j),(s,i)}(\\Delta t) =\n     \\begin{cases}\n        {\\frac { \\beta i s} { N}} \\Delta t, & {(k, j) = (-1, 1) } \\\\\n        { \\gamma i \\Delta t}, & { (k, j) = (0, -1)  } \\\\\n        { 1 - \\bigg[ \\frac { \\beta i s } { N } +  \\gamma i }\\bigg] \\Delta t, & { (k, j) = (0, 0)} \\\\\n        0, & {otherwise}\n    \\end{cases}\n\\tag{4.1}\n\n\n\n\n\n   \n\nS = 0 I = 1\n\n S = 0   I = 1   \n\nS = 0 I = 0\n\n S = 0   I = 0   \n\nS = 0 I = 1->S = 0 I = 0\n\n    \n\nS = 0 I = 2\n\n S = 0   I = 2   \n\nS = 0 I = 2->S = 0 I = 1\n\n    \n\nS = 0 I = ~\n\n S = 0   I = ~   \n\nS = 0 I = ~->S = 0 I = 2\n\n    \n\nS = 0 I = N\n\n S = 0   I = N   \n\nS = 0 I = N - 1\n\n S = 0   I = N - 1   \n\nS = 0 I = N->S = 0 I = N - 1\n\n    \n\nS = 0 I = N - 2\n\n S = 0   I = N - 2   \n\nS = 0 I = N - 1->S = 0 I = N - 2\n\n    \n\nS = 0 I = N - 2->S = 0 I = ~\n\n    \n\nS = 1 I = 1\n\n S = 1   I = 1   \n\nS = 1 I = 1->S = 0 I = 2\n\n    \n\nS = 1 I = 2\n\n S = 1   I = 2   \n\nS = 1 I = 2->S = 0 I = ~\n\n    \n\nS = 1 I = 2->S = 1 I = 1\n\n    \n\nS = 1 I = ~\n\n S = 1   I = ~   \n\nS = 1 I = ~->S = 0 I = ~\n\n    \n\nS = 1 I = ~->S = 0 I = N - 1\n\n    \n\nS = 1 I = ~->S = 1 I = 2\n\n    \n\nS = 1 I = N - 1\n\n S = 1   I = N - 1   \n\nS = 1 I = N - 1->S = 0 I = N\n\n    \n\nS = 1 I = N - 2\n\n S = 1   I = N - 2   \n\nS = 1 I = N - 1->S = 1 I = N - 2\n\n    \n\nS = 1 I = N - 2->S = 0 I = N - 1\n\n    \n\nS = 1 I = N - 2->S = 1 I = ~\n\n    \n\nS = 2 I = 1\n\n S = 2   I = 1   \n\nS = 2 I = 1->S = 1 I = 2\n\n    \n\nS = 2 I = 0\n\n S = 2   I = 0   \n\nS = 2 I = 1->S = 2 I = 0\n\n    \n\nS = 2 I = 2\n\n S = 2   I = 2   \n\nS = 2 I = 2->S = 1 I = ~\n\n    \n\nS = 2 I = 2->S = 2 I = 1\n\n    \n\nS = 2 I = ~\n\n S = 2   I = ~   \n\nS = 2 I = ~->S = 1 I = ~\n\n    \n\nS = 2 I = ~->S = 1 I = N - 2\n\n    \n\nS = 2 I = ~->S = 2 I = 2\n\n    \n\nS = 2 I = N - 2\n\n S = 2   I = N - 2   \n\nS = 2 I = N - 2->S = 1 I = N - 1\n\n    \n\nS = 2 I = N - 2->S = 2 I = ~\n\n    \n\nS = ~ I = 1\n\n S = ~   I = 1   \n\nS = ~ I = 1->S = 2 I = 2\n\n    \n\nS = ~ I = 0\n\n S = ~   I = 0   \n\nS = ~ I = 1->S = ~ I = 0\n\n    \n\nS = ~ I = 2\n\n S = ~   I = 2   \n\nS = ~ I = 1->S = ~ I = 2\n\n    \n\nS = ~ I = 2->S = 2 I = ~\n\n    \n\nS = ~ I = 2->S = ~ I = 1\n\n    \n\nS = ~ I = ~\n\n S = ~   I = ~   \n\nS = ~ I = 2->S = ~ I = ~\n\n    \n\nS = ~ I = ~->S = 2 I = ~\n\n    \n\nS = ~ I = ~->S = 2 I = N - 2\n\n    \n\nS = ~ I = ~->S = ~ I = 2\n\n    \n\nS = ~ I = ~->S = ~ I = ~\n\n    \n\nS = ~ I = ~->S = ~ I = ~\n\n    \n\nS = N - 1 I = 1\n\n S = N - 1   I = 1   \n\nS = N - 2 I = 2\n\n S = N - 2   I = 2   \n\nS = N - 1 I = 1->S = N - 2 I = 2\n\n    \n\nS = N - 1I = 0\n\n S = N - 1  I = 0   \n\nS = N - 1 I = 1->S = N - 1I = 0\n\n    \n\nS = N - 2 I = 2->S = ~ I = ~\n\n    \n\nS = N - 2 I = 1\n\n S = N - 2   I = 1   \n\nS = N - 2 I = 2->S = N - 2 I = 1\n\n    \n\nS = N - 2 I = 1->S = ~ I = 2\n\n    \n\nS = N - 2 I = 0\n\n S = N - 2   I = 0   \n\nS = N - 2 I = 1->S = N - 2 I = 0\n\n   \n\n\n\n\n\nThere are (N + 1)(N + 2)/2 ordered pairs of states (s, i)\n\n\n#25 (generic function with 1 method)\n\n\n\n\n496×496 Matrix{Real}:\n 1.0  0    0    0    0    0    0    0    …   0       0      0       0\n 0    1.0  0    0    0    0    0    0        0       0      0       0\n 0    0    1.0  0    0    0    0    0        0       0      0       0\n 0    0    0    1.0  0    0    0    0        0       0      0       0\n 0    0    0    0    1.0  0    0    0        0       0      0       0\n 0    0    0    0    0    1.0  0    0    …   0       0      0       0\n 0    0    0    0    0    0    1.0  0        0       0      0       0\n 0    0    0    0    0    0    0    1.0      0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0    …   0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n ⋮                        ⋮              ⋱                          ⋮\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0    …   0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0        0       0      0       0\n 0    0    0    0    0    0    0    0        0.405   0      0       0\n 0    0    0    0    0    0    0    0    …   0       0      0       0\n 0    0    0    0    0    0    0    0        0       0.14   0       0\n 0    0    0    0    0    0    0    0       -2.08    0      0.28    0\n 0    0    0    0    0    0    0    0        0      -1.9    0       0\n 0    0    0    0    0    0    0    0        0       0     -2.045   0.145\n 0    0    0    0    0    0    0    0    …   0       3.0    0      -2.0"
  },
  {
    "objectID": "Notes/shapefiles.html",
    "href": "Notes/shapefiles.html",
    "title": "5  Maps and shapefiles in julia",
    "section": "",
    "text": "Create an index of the SA3 regions in the Greater Melbourne GCC\n\n\n(Tables.DictColumnTable with 11487 rows, 18 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA1_CODE21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA2_CODE21  Union{Missing, String}\n :SA2_NAME21  Union{Missing, String}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 361 rows, 17 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA2_CODE21  Union{Missing, String}\n :SA2_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 40 rows, 15 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 9 rows, 13 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String})"
  },
  {
    "objectID": "notes.html",
    "href": "notes.html",
    "title": "Notes",
    "section": "",
    "text": "This contains WIP notes on subjects relating to the thesis, but not in a form appropriate for publication."
  }
]