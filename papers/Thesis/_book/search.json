[
  {
    "objectID": "test.html",
    "href": "test.html",
    "title": "2  Untitled",
    "section": "",
    "text": "Just a test file"
  },
  {
    "objectID": "notes.html",
    "href": "notes.html",
    "title": "Notes",
    "section": "",
    "text": "This contains WIP notes on subjects relating to the thesis, but not in a form appropriate for publication."
  },
  {
    "objectID": "Notes/Moss.html",
    "href": "Notes/Moss.html",
    "title": "3  Replicating Moss et al. 2019",
    "section": "",
    "text": "using DrWatson\n@quickactivate \"SCI499\"\n\n\nusing CSV\n\nget the mixing matrix from CSV\n\nfrac_self = 0.5\nfrac_cbd = 0.2\npath = joinpath(datadir(), \"Moss2018\\\\mixing\\\\abs_all.csv\")\nmixmat =CSV.File(path) \n\n38-element CSV.File:\n CSV.Row: (Column1 = 20601, var\"20601\" = 0.0, var\"20602\" = 0.0164303286065721, var\"20603\" = 0.0278205564111282, var\"20604\" = 0.484109682193644, var\"20605\" = 0.0448208964179284, var\"20606\" = 0.0144302886057721, var\"20607\" = 0.0946318926378528, var\"20701\" = 0.0256805136102722, var\"20702\" = 0.00491009820196404, var\"20703\" = 0.0109102182043641, var\"20801\" = 0.00204004080081602, var\"20802\" = 0.00526010520210404, var\"20803\" = 0.00372007440148803, var\"20804\" = 0.00418008360167203, var\"20901\" = 0.0196303926078522, var\"20902\" = 0.0296005920118402, var\"20903\" = 0.00200004000080002, var\"20904\" = 0.0180303606072121, var\"21001\" = 0.0219304386087722, var\"21002\" = 0.000340006800136003, var\"21003\" = 0.0275005500110002, var\"21004\" = 0.00140002800056001, var\"21005\" = 0.0505510110202204, var\"21101\" = 0.00360007200144003, var\"21102\" = 0.000280005600112002, var\"21103\" = 0.00210004200084002, var\"21104\" = 0.00289005780115602, var\"21105\" = 0.000790015800316006, var\"21201\" = 0.000180003600072001, var\"21202\" = 0.000870017400348007, var\"21203\" = 0.0, var\"21204\" = 0.00582011640232805, var\"21205\" = 0.0141302826056521, var\"21301\" = 0.0186903738074761, var\"21302\" = 0.00853017060341207, var\"21303\" = 0.0229404588091762, var\"21304\" = 0.00255005100102002, var\"21305\" = 0.00670013400268005)\n CSV.Row: (Column1 = 20602, var\"20601\" = 0.03287, var\"20602\" = 0.0, var\"20603\" = 0.0103, var\"20604\" = 0.41926, var\"20605\" = 0.03697, var\"20606\" = 0.01599, var\"20607\" = 0.13538, var\"20701\" = 0.04499, var\"20702\" = 0.0085, var\"20703\" = 0.01868, var\"20801\" = 0.00268, var\"20802\" = 0.00559, var\"20803\" = 0.00399, var\"20804\" = 0.00497, var\"20901\" = 0.04262, var\"20902\" = 0.06331, var\"20903\" = 0.00323, var\"20904\" = 0.02728, var\"21001\" = 0.00756, var\"21002\" = 0.0, var\"21003\" = 0.00962, var\"21004\" = 0.00054, var\"21005\" = 0.02632, var\"21101\" = 0.00515, var\"21102\" = 0.00087, var\"21103\" = 0.00566, var\"21104\" = 0.00475, var\"21105\" = 0.00215, var\"21201\" = 0.0, var\"21202\" = 0.00072, var\"21203\" = 0.0, var\"21204\" = 0.00697, var\"21205\" = 0.01894, var\"21301\" = 0.01081, var\"21302\" = 0.00499, var\"21303\" = 0.01243, var\"21304\" = 0.0015, var\"21305\" = 0.00441)\n CSV.Row: (Column1 = 20603, var\"20601\" = 0.02999, var\"20602\" = 0.00672, var\"20603\" = 0.0, var\"20604\" = 0.45501, var\"20605\" = 0.04214, var\"20606\" = 0.01249, var\"20607\" = 0.05608, var\"20701\" = 0.02107, var\"20702\" = 0.00305, var\"20703\" = 0.00713, var\"20801\" = 0.00203, var\"20802\" = 0.0055, var\"20803\" = 0.00379, var\"20804\" = 0.00329, var\"20901\" = 0.00976, var\"20902\" = 0.01262, var\"20903\" = 0.0005, var\"20904\" = 0.01235, var\"21001\" = 0.06113, var\"21002\" = 0.00088, var\"21003\" = 0.01751, var\"21004\" = 0.00392, var\"21005\" = 0.0741, var\"21101\" = 0.00228, var\"21102\" = 0.00018, var\"21103\" = 0.00167, var\"21104\" = 0.00206, var\"21105\" = 0.00056, var\"21201\" = 0.0, var\"21202\" = 0.00098, var\"21203\" = 0.0, var\"21204\" = 0.00526, var\"21205\" = 0.01208, var\"21301\" = 0.03852, var\"21302\" = 0.01666, var\"21303\" = 0.05495, var\"21304\" = 0.0063, var\"21305\" = 0.01744)\n CSV.Row: (Column1 = 20604, var\"20601\" = 0.028009719902801, var\"20602\" = 0.00846991530084699, var\"20603\" = 0.030229697703023, var\"20604\" = 0.0, var\"20605\" = 0.171008289917101, var\"20606\" = 0.0639493605063949, var\"20607\" = 0.196548034519655, var\"20701\" = 0.0692893071069289, var\"20702\" = 0.00637993620063799, var\"20703\" = 0.025939740602594, var\"20801\" = 0.010939890601094, var\"20802\" = 0.020729792702073, var\"20803\" = 0.016019839801602, var\"20804\" = 0.014819851801482, var\"20901\" = 0.017139828601714, var\"20902\" = 0.01689983100169, var\"20903\" = 0.001029989700103, var\"20904\" = 0.011929880701193, var\"21001\" = 0.017089829101709, var\"21002\" = 0.000909990900090999, var\"21003\" = 0.00673993260067399, var\"21004\" = 0.001539984600154, var\"21005\" = 0.042929570704293, var\"21101\" = 0.01119988800112, var\"21102\" = 0.000369996300037, var\"21103\" = 0.00648993510064899, var\"21104\" = 0.010119898801012, var\"21105\" = 0.002849971500285, var\"21201\" = 0.000359996400036, var\"21202\" = 0.002969970300297, var\"21203\" = 0.000189998100019, var\"21204\" = 0.020149798502015, var\"21205\" = 0.0471695283047169, var\"21301\" = 0.027879721202788, var\"21302\" = 0.024239757602424, var\"21303\" = 0.044029559704403, var\"21304\" = 0.002429975700243, var\"21305\" = 0.021009789902101)\n CSV.Row: (Column1 = 20605, var\"20601\" = 0.00586, var\"20602\" = 0.003, var\"20603\" = 0.00518, var\"20604\" = 0.53274, var\"20605\" = 0.0, var\"20606\" = 0.05993, var\"20607\" = 0.07664, var\"20701\" = 0.03769, var\"20702\" = 0.00233, var\"20703\" = 0.01274, var\"20801\" = 0.02443, var\"20802\" = 0.03818, var\"20803\" = 0.02449, var\"20804\" = 0.01668, var\"20901\" = 0.00583, var\"20902\" = 0.00561, var\"20903\" = 0.00064, var\"20904\" = 0.00406, var\"21001\" = 0.00506, var\"21002\" = 0.0, var\"21003\" = 0.00204, var\"21004\" = 0.00069, var\"21005\" = 0.01664, var\"21101\" = 0.00682, var\"21102\" = 7.0e-5, var\"21103\" = 0.00265, var\"21104\" = 0.00397, var\"21105\" = 0.00099, var\"21201\" = 0.00052, var\"21202\" = 0.00302, var\"21203\" = 0.00059, var\"21204\" = 0.01945, var\"21205\" = 0.04001, var\"21301\" = 0.00814, var\"21302\" = 0.01013, var\"21303\" = 0.01343, var\"21304\" = 0.00091, var\"21305\" = 0.00884)\n CSV.Row: (Column1 = 20606, var\"20601\" = 0.00396, var\"20602\" = 0.00288, var\"20603\" = 0.00391, var\"20604\" = 0.49602, var\"20605\" = 0.10922, var\"20606\" = 0.0, var\"20607\" = 0.09963, var\"20701\" = 0.05224, var\"20702\" = 0.00364, var\"20703\" = 0.01355, var\"20801\" = 0.01226, var\"20802\" = 0.02504, var\"20803\" = 0.01504, var\"20804\" = 0.02725, var\"20901\" = 0.00452, var\"20902\" = 0.00501, var\"20903\" = 0.0, var\"20904\" = 0.0034, var\"21001\" = 0.00337, var\"21002\" = 0.00012, var\"21003\" = 0.00144, var\"21004\" = 0.0, var\"21005\" = 0.0105, var\"21101\" = 0.00661, var\"21102\" = 0.0, var\"21103\" = 0.00275, var\"21104\" = 0.00419, var\"21105\" = 0.00065, var\"21201\" = 0.00062, var\"21202\" = 0.00339, var\"21203\" = 0.00038, var\"21204\" = 0.02037, var\"21205\" = 0.04526, var\"21301\" = 0.00446, var\"21302\" = 0.005, var\"21303\" = 0.00745, var\"21304\" = 0.00051, var\"21305\" = 0.00536)\n CSV.Row: (Column1 = 20607, var\"20601\" = 0.0164, var\"20602\" = 0.01406, var\"20603\" = 0.00735, var\"20604\" = 0.57249, var\"20605\" = 0.06274, var\"20606\" = 0.03436, var\"20607\" = 0.0, var\"20701\" = 0.05946, var\"20702\" = 0.00571, var\"20703\" = 0.01975, var\"20801\" = 0.00393, var\"20802\" = 0.01249, var\"20803\" = 0.00783, var\"20804\" = 0.00987, var\"20901\" = 0.02098, var\"20902\" = 0.01746, var\"20903\" = 0.00155, var\"20904\" = 0.00994, var\"21001\" = 0.00537, var\"21002\" = 0.00035, var\"21003\" = 0.00338, var\"21004\" = 0.00027, var\"21005\" = 0.01421, var\"21101\" = 0.00843, var\"21102\" = 0.00046, var\"21103\" = 0.00642, var\"21104\" = 0.00505, var\"21105\" = 0.00222, var\"21201\" = 0.00037, var\"21202\" = 0.00152, var\"21203\" = 0.00016, var\"21204\" = 0.01261, var\"21205\" = 0.02847, var\"21301\" = 0.00754, var\"21302\" = 0.00612, var\"21303\" = 0.0151, var\"21304\" = 0.00051, var\"21305\" = 0.00507)\n CSV.Row: (Column1 = 20701, var\"20601\" = 0.00808983820323594, var\"20602\" = 0.00778984420311594, var\"20603\" = 0.00452990940181196, var\"20604\" = 0.414701705965881, var\"20605\" = 0.0492390152196956, var\"20606\" = 0.0369892602147957, var\"20607\" = 0.105987880242395, var\"20701\" = 0.0, var\"20702\" = 0.0198796024079518, var\"20703\" = 0.0565588688226235, var\"20801\" = 0.00637987240255195, var\"20802\" = 0.0174596508069839, var\"20803\" = 0.0128297434051319, var\"20804\" = 0.0278894422111558, var\"20901\" = 0.0230395392092158, var\"20902\" = 0.0134997300053999, var\"20903\" = 0.00209995800083998, var\"20904\" = 0.00825983480330393, var\"21001\" = 0.00434991300173996, var\"21002\" = 0.000179996400071999, var\"21003\" = 0.00258994820103598, var\"21004\" = 0.000159996800063999, var\"21005\" = 0.0116897662046759, var\"21101\" = 0.0170396592068159, var\"21102\" = 0.000839983200335993, var\"21103\" = 0.0121697566048679, var\"21104\" = 0.0150396992060159, var\"21105\" = 0.00438991220175596, var\"21201\" = 0.000489990200195996, var\"21202\" = 0.00469990600187996, var\"21203\" = 0.00134997300053999, var\"21204\" = 0.0244195116097678, var\"21205\" = 0.0636387272254555, var\"21301\" = 0.00554988900221996, var\"21302\" = 0.00495990080198396, var\"21303\" = 0.00733985320293594, var\"21304\" = 0.000399992000159997, var\"21305\" = 0.00347993040139197)\n CSV.Row: (Column1 = 20702, var\"20601\" = 0.0147597048059039, var\"20602\" = 0.0117397652046959, var\"20603\" = 0.00444991100177997, var\"20604\" = 0.279594408111838, var\"20605\" = 0.0299894002119958, var\"20606\" = 0.0156096878062439, var\"20607\" = 0.0703785924281514, var\"20701\" = 0.0939681206375873, var\"20702\" = 0.0, var\"20703\" = 0.0912481750364993, var\"20801\" = 0.00234995300093998, var\"20802\" = 0.00712985740285194, var\"20803\" = 0.0103597928041439, var\"20804\" = 0.00884982300353993, var\"20901\" = 0.0513189736205276, var\"20902\" = 0.0295194096118078, var\"20903\" = 0.00987980240395192, var\"20904\" = 0.0224695506089878, var\"21001\" = 0.00594988100237995, var\"21002\" = 9.99980000399992e-5, var\"21003\" = 0.00711985760284794, var\"21004\" = 0.000199996000079998, var\"21005\" = 0.0235395292094158, var\"21101\" = 0.0268694626107478, var\"21102\" = 0.00788984220315594, var\"21103\" = 0.0267494650106998, var\"21104\" = 0.0359492810143797, var\"21105\" = 0.00823983520329594, var\"21201\" = 0.000609987800243995, var\"21202\" = 0.00304993900121998, var\"21203\" = 0.000839983200335993, var\"21204\" = 0.0278294434111318, var\"21205\" = 0.0496390072198556, var\"21301\" = 0.00688986220275595, var\"21302\" = 0.00434991300173997, var\"21303\" = 0.00793984120317594, var\"21304\" = 0.000249995000099998, var\"21305\" = 0.00237995240095198)\n CSV.Row: (Column1 = 20703, var\"20601\" = 0.00587994120058799, var\"20602\" = 0.00539994600053999, var\"20603\" = 0.002279977200228, var\"20604\" = 0.282367176328237, var\"20605\" = 0.035639643603564, var\"20606\" = 0.018189818101819, var\"20607\" = 0.0574594254057459, var\"20701\" = 0.136278637213628, var\"20702\" = 0.037289627103729, var\"20703\" = 0.0, var\"20801\" = 0.00523994760052399, var\"20802\" = 0.014969850301497, var\"20803\" = 0.015539844601554, var\"20804\" = 0.02229977700223, var\"20901\" = 0.019149808501915, var\"20902\" = 0.00986990130098699, var\"20903\" = 0.002889971100289, var\"20904\" = 0.00553994460055399, var\"21001\" = 0.002419975800242, var\"21002\" = 0.0, var\"21003\" = 0.001909980900191, var\"21004\" = 0.0, var\"21005\" = 0.00860991390086099, var\"21101\" = 0.043259567404326, var\"21102\" = 0.00289997100029, var\"21103\" = 0.03349966500335, var\"21104\" = 0.0567994320056799, var\"21105\" = 0.010889891101089, var\"21201\" = 0.000689993100068999, var\"21202\" = 0.00600993990060099, var\"21203\" = 0.001449985500145, var\"21204\" = 0.041509584904151, var\"21205\" = 0.100138998610014, var\"21301\" = 0.003119968800312, var\"21302\" = 0.003759962400376, var\"21303\" = 0.004229957700423, var\"21304\" = 0.000289997100029, var\"21305\" = 0.002229977700223)\n CSV.Row: (Column1 = 20801, var\"20601\" = 0.00229, var\"20602\" = 0.00193, var\"20603\" = 0.00191, var\"20604\" = 0.34529, var\"20605\" = 0.1005, var\"20606\" = 0.03925, var\"20607\" = 0.04223, var\"20701\" = 0.03117, var\"20702\" = 0.00123, var\"20703\" = 0.01074, var\"20801\" = 0.0, var\"20802\" = 0.07206, var\"20803\" = 0.14831, var\"20804\" = 0.01915, var\"20901\" = 0.00173, var\"20902\" = 0.0031, var\"20903\" = 0.00019, var\"20904\" = 0.00189, var\"21001\" = 0.00207, var\"21002\" = 0.0, var\"21003\" = 0.00066, var\"21004\" = 0.0001, var\"21005\" = 0.00911, var\"21101\" = 0.01011, var\"21102\" = 0.0, var\"21103\" = 0.00249, var\"21104\" = 0.0037, var\"21105\" = 0.0002, var\"21201\" = 0.00023, var\"21202\" = 0.00473, var\"21203\" = 0.00234, var\"21204\" = 0.05073, var\"21205\" = 0.06638, var\"21301\" = 0.00519, var\"21302\" = 0.00724, var\"21303\" = 0.00618, var\"21304\" = 0.00073, var\"21305\" = 0.00484)\n CSV.Row: (Column1 = 20802, var\"20601\" = 0.00369992600147997, var\"20602\" = 0.00191996160076799, var\"20603\" = 0.00263994720105598, var\"20604\" = 0.337293254134917, var\"20605\" = 0.0972080558388832, var\"20606\" = 0.0482890342193156, var\"20607\" = 0.0515289694206116, var\"20701\" = 0.0431891362172757, var\"20702\" = 0.00267994640107198, var\"20703\" = 0.0199596008079838, var\"20801\" = 0.0449091018179636, var\"20802\" = 0.0, var\"20803\" = 0.0848483030339393, var\"20804\" = 0.0421891562168757, var\"20901\" = 0.00362992740145197, var\"20902\" = 0.00325993480130397, var\"20903\" = 0.000189996200075999, var\"20904\" = 0.00210995780084398, var\"21001\" = 0.00249995000099998, var\"21002\" = 0.0, var\"21003\" = 0.000749985000299994, var\"21004\" = 5.99988000239995e-5, var\"21005\" = 0.00619987600247995, var\"21101\" = 0.0115997680046399, var\"21102\" = 8.99982000359993e-5, var\"21103\" = 0.00427991440171197, var\"21104\" = 0.00543989120217596, var\"21105\" = 0.000989980200395992, var\"21201\" = 0.00116997660046799, var\"21202\" = 0.00659986800263995, var\"21203\" = 0.00206995860082798, var\"21204\" = 0.0528489430211396, var\"21205\" = 0.0942781144377113, var\"21301\" = 0.00462990740185196, var\"21302\" = 0.00511989760204796, var\"21303\" = 0.00716985660286794, var\"21304\" = 0.000549989000219996, var\"21305\" = 0.00410991780164397)\n CSV.Row: (Column1 = 20803, var\"20601\" = 0.00137002740054801, var\"20602\" = 0.00164003280065601, var\"20603\" = 0.00115002300046001, var\"20604\" = 0.25892517850357, var\"20605\" = 0.0602612052241045, var\"20606\" = 0.0238604772095442, var\"20607\" = 0.0340206804136083, var\"20701\" = 0.0272205444108882, var\"20702\" = 0.00210004200084002, var\"20703\" = 0.0147602952059041, var\"20801\" = 0.101222024440489, var\"20802\" = 0.0738714774295486, var\"20803\" = 0.0, var\"20804\" = 0.0189703794075881, var\"20901\" = 0.00239004780095602, var\"20902\" = 0.00157003140062801, var\"20903\" = 0.000270005400108002, var\"20904\" = 0.00143002860057201, var\"21001\" = 0.00173003460069201, var\"21002\" = 0.0, var\"21003\" = 0.000380007600152003, var\"21004\" = 0.0, var\"21005\" = 0.00598011960239205, var\"21101\" = 0.0205304106082122, var\"21102\" = 0.0, var\"21103\" = 0.00538010760215204, var\"21104\" = 0.00534010680213604, var\"21105\" = 0.00120002400048001, var\"21201\" = 0.00192003840076802, var\"21202\" = 0.0178903578071561, var\"21203\" = 0.00933018660373207, var\"21204\" = 0.167723354467089, var\"21205\" = 0.120162403248065, var\"21301\" = 0.00355007100142003, var\"21302\" = 0.00585011700234005, var\"21303\" = 0.00392007840156803, var\"21304\" = 0.000500010000200004, var\"21305\" = 0.00358007160143203)\n ⋮\n CSV.Row: (Column1 = 21104, var\"20601\" = 0.00365, var\"20602\" = 0.00362, var\"20603\" = 0.00118, var\"20604\" = 0.23164, var\"20605\" = 0.02684, var\"20606\" = 0.01141, var\"20607\" = 0.04199, var\"20701\" = 0.07593, var\"20702\" = 0.03214, var\"20703\" = 0.12792, var\"20801\" = 0.00309, var\"20802\" = 0.01177, var\"20803\" = 0.01617, var\"20804\" = 0.01147, var\"20901\" = 0.01507, var\"20902\" = 0.00697, var\"20903\" = 0.00205, var\"20904\" = 0.00468, var\"21001\" = 0.00241, var\"21002\" = 0.0, var\"21003\" = 0.00102, var\"21004\" = 0.0, var\"21005\" = 0.00689, var\"21101\" = 0.08503, var\"21102\" = 0.00574, var\"21103\" = 0.06735, var\"21104\" = 0.0, var\"21105\" = 0.01865, var\"21201\" = 0.00103, var\"21202\" = 0.0077, var\"21203\" = 0.00217, var\"21204\" = 0.05024, var\"21205\" = 0.11336, var\"21301\" = 0.00192, var\"21302\" = 0.00365, var\"21303\" = 0.00286, var\"21304\" = 0.00034, var\"21305\" = 0.00205)\n CSV.Row: (Column1 = 21105, var\"20601\" = 0.001440014400144, var\"20602\" = 0.002810028100281, var\"20603\" = 0.000380003800038, var\"20604\" = 0.112971129711297, var\"20605\" = 0.013880138801388, var\"20606\" = 0.00605006050060501, var\"20607\" = 0.02490024900249, var\"20701\" = 0.037470374703747, var\"20702\" = 0.015820158201582, var\"20703\" = 0.0590505905059051, var\"20801\" = 0.002650026500265, var\"20802\" = 0.00570005700057001, var\"20803\" = 0.0120001200012, var\"20804\" = 0.00625006250062501, var\"20901\" = 0.00811008110081101, var\"20902\" = 0.004330043300433, var\"20903\" = 0.00580005800058001, var\"20904\" = 0.00623006230062301, var\"21001\" = 0.001650016500165, var\"21002\" = 0.0, var\"21003\" = 0.000540005400054001, var\"21004\" = 0.0, var\"21005\" = 0.00647006470064701, var\"21101\" = 0.210082100821008, var\"21102\" = 0.00590005900059001, var\"21103\" = 0.218312183121831, var\"21104\" = 0.046190461904619, var\"21105\" = 0.0, var\"21201\" = 0.012140121401214, var\"21202\" = 0.021580215802158, var\"21203\" = 0.004760047600476, var\"21204\" = 0.0587705877058771, var\"21205\" = 0.0795907959079591, var\"21301\" = 0.002290022900229, var\"21302\" = 0.002730027300273, var\"21303\" = 0.001350013500135, var\"21304\" = 0.000160001600016, var\"21305\" = 0.001640016400164)\n CSV.Row: (Column1 = 21201, var\"20601\" = 0.000769992300076999, var\"20602\" = 0.000429995700043, var\"20603\" = 0.000159998400016, var\"20604\" = 0.0792092079079209, var\"20605\" = 0.011029889701103, var\"20606\" = 0.00533994660053399, var\"20607\" = 0.011609883901161, var\"20701\" = 0.016289837101629, var\"20702\" = 0.003509964900351, var\"20703\" = 0.016889831101689, var\"20801\" = 0.004129958700413, var\"20802\" = 0.010039899601004, var\"20803\" = 0.037809621903781, var\"20804\" = 0.00852991470085299, var\"20901\" = 0.001059989400106, var\"20902\" = 0.0019999800002, var\"20903\" = 0.000149998500015, var\"20904\" = 0.001439985600144, var\"21001\" = 0.001319986800132, var\"21002\" = 0.000239997600024, var\"21003\" = 0.000169998300017, var\"21004\" = 0.0, var\"21005\" = 0.003449965500345, var\"21101\" = 0.0842991570084299, var\"21102\" = 0.000449995500045, var\"21103\" = 0.020789792102079, var\"21104\" = 0.00954990450095499, var\"21105\" = 0.042369576304237, var\"21201\" = 0.0, var\"21202\" = 0.20159798402016, var\"21203\" = 0.0633393666063339, var\"21204\" = 0.245837541624584, var\"21205\" = 0.109268907310927, var\"21301\" = 0.002429975700243, var\"21302\" = 0.001939980600194, var\"21303\" = 0.001279987200128, var\"21304\" = 0.000319996800032, var\"21305\" = 0.000949990500094999)\n CSV.Row: (Column1 = 21202, var\"20601\" = 0.000970038801552062, var\"20602\" = 0.00130005200208008, var\"20603\" = 0.000900036001440057, var\"20604\" = 0.109424376975079, var\"20605\" = 0.0189207568302732, var\"20606\" = 0.0104404176167047, var\"20607\" = 0.0174706988279531, var\"20701\" = 0.0186407456298252, var\"20702\" = 0.0032001280051202, var\"20703\" = 0.0200608024320973, var\"20801\" = 0.00967038681547262, var\"20802\" = 0.0185607424296972, var\"20803\" = 0.0635625425017001, var\"20804\" = 0.014960598423937, var\"20901\" = 0.00177007080283211, var\"20902\" = 0.00248009920396816, var\"20903\" = 0.000250010000400016, var\"20904\" = 0.00189007560302412, var\"21001\" = 0.000870034801392056, var\"21002\" = 0.0, var\"21003\" = 0.000480019200768031, var\"21004\" = 8.00032001280051e-5, var\"21005\" = 0.00443017720708828, var\"21101\" = 0.0711728469138765, var\"21102\" = 0.000270010800432017, var\"21103\" = 0.016130645225809, var\"21104\" = 0.00991039641585663, var\"21105\" = 0.00828033121324853, var\"21201\" = 0.0442817712708508, var\"21202\" = 0.0, var\"21203\" = 0.0502520100804032, var\"21204\" = 0.325903036121445, var\"21205\" = 0.142385695427817, var\"21301\" = 0.00258010320412816, var\"21302\" = 0.00375015000600024, var\"21303\" = 0.00235009400376015, var\"21304\" = 0.000240009600384015, var\"21305\" = 0.00216008640345614)\n CSV.Row: (Column1 = 21203, var\"20601\" = 0.0008, var\"20602\" = 0.00069, var\"20603\" = 0.00087, var\"20604\" = 0.09211, var\"20605\" = 0.01343, var\"20606\" = 0.00729, var\"20607\" = 0.01431, var\"20701\" = 0.01568, var\"20702\" = 0.00217, var\"20703\" = 0.01562, var\"20801\" = 0.01017, var\"20802\" = 0.01658, var\"20803\" = 0.07855, var\"20804\" = 0.00896, var\"20901\" = 0.00118, var\"20902\" = 0.0004, var\"20903\" = 7.0e-5, var\"20904\" = 0.00129, var\"21001\" = 0.00123, var\"21002\" = 0.0, var\"21003\" = 0.00026, var\"21004\" = 0.0, var\"21005\" = 0.00262, var\"21101\" = 0.05545, var\"21102\" = 0.00013, var\"21103\" = 0.01299, var\"21104\" = 0.00709, var\"21105\" = 0.00456, var\"21201\" = 0.02518, var\"21202\" = 0.13822, var\"21203\" = 0.0, var\"21204\" = 0.34421, var\"21205\" = 0.11942, var\"21301\" = 0.00183, var\"21302\" = 0.00262, var\"21303\" = 0.00159, var\"21304\" = 0.00028, var\"21305\" = 0.00215)\n CSV.Row: (Column1 = 21204, var\"20601\" = 0.00201995960080798, var\"20602\" = 0.00197996040079198, var\"20603\" = 0.000509989800203996, var\"20604\" = 0.164966700665987, var\"20605\" = 0.0303893922121558, var\"20606\" = 0.0167196656066879, var\"20607\" = 0.0279794404111918, var\"20701\" = 0.0271594568108638, var\"20702\" = 0.00431991360172797, var\"20703\" = 0.0255494890102198, var\"20801\" = 0.0321793564128717, var\"20802\" = 0.0515889682206356, var\"20803\" = 0.191146177076458, var\"20804\" = 0.0235795284094318, var\"20901\" = 0.00219995600087998, var\"20902\" = 0.00310993780124398, var\"20903\" = 0.000189996200075999, var\"20904\" = 0.00255994880102398, var\"21001\" = 0.00157996840063199, var\"21002\" = 0.0, var\"21003\" = 0.000609987800243995, var\"21004\" = 0.0, var\"21005\" = 0.00401991960160797, var\"21101\" = 0.0548489030219396, var\"21102\" = 0.000469990600187996, var\"21103\" = 0.0149197016059679, var\"21104\" = 0.0124497510049799, var\"21105\" = 0.00474990500189996, var\"21201\" = 0.00457990840183196, var\"21202\" = 0.0436491270174597, var\"21203\" = 0.0178596428071439, var\"21204\" = 0.0, var\"21205\" = 0.216455670886582, var\"21301\" = 0.00316993660126798, var\"21302\" = 0.00531989360212796, var\"21303\" = 0.00406991860162797, var\"21304\" = 0.000159996800063999, var\"21305\" = 0.00293994120117598)\n CSV.Row: (Column1 = 21205, var\"20601\" = 0.00334989950301491, var\"20602\" = 0.00179994600161995, var\"20603\" = 0.00165995020149396, var\"20604\" = 0.26932192034239, var\"20605\" = 0.0436786896393108, var\"20606\" = 0.0255692329230123, var\"20607\" = 0.0408587742367729, var\"20701\" = 0.0613081607551774, var\"20702\" = 0.00825975220743378, var\"20703\" = 0.0605781826545204, var\"20801\" = 0.0148195554133376, var\"20802\" = 0.0453786386408408, var\"20803\" = 0.0549683509494715, var\"20804\" = 0.0458386248412548, var\"20901\" = 0.00600981970540884, var\"20902\" = 0.00554983350499485, var\"20903\" = 0.000319990400287991, var\"20904\" = 0.00303990880273592, var\"21001\" = 0.00225993220203394, var\"21002\" = 0.0, var\"21003\" = 0.000859974200773977, var\"21004\" = 0.0, var\"21005\" = 0.00656980290591282, var\"21101\" = 0.0641980740577783, var\"21102\" = 0.000839974800755977, var\"21103\" = 0.0182894513164605, var\"21104\" = 0.0251292461226163, var\"21105\" = 0.00575982720518385, var\"21201\" = 0.00269991900242993, var\"21202\" = 0.0198594042178735, var\"21203\" = 0.00671979840604782, var\"21204\" = 0.136115916522504, var\"21205\" = 0.0, var\"21301\" = 0.0037898863034109, var\"21302\" = 0.00491985240442787, var\"21303\" = 0.00569982900512985, var\"21304\" = 0.00036998890033299, var\"21305\" = 0.0036098917032489)\n CSV.Row: (Column1 = 21301, var\"20601\" = 0.01772, var\"20602\" = 0.00506, var\"20603\" = 0.03001, var\"20604\" = 0.26966, var\"20605\" = 0.0351, var\"20606\" = 0.00848, var\"20607\" = 0.03896, var\"20701\" = 0.01048, var\"20702\" = 0.00094, var\"20703\" = 0.0042, var\"20801\" = 0.00158, var\"20802\" = 0.00318, var\"20803\" = 0.00374, var\"20804\" = 0.00277, var\"20901\" = 0.00552, var\"20902\" = 0.01519, var\"20903\" = 0.00093, var\"20904\" = 0.02093, var\"21001\" = 0.07586, var\"21002\" = 0.00117, var\"21003\" = 0.01307, var\"21004\" = 0.00478, var\"21005\" = 0.10038, var\"21101\" = 0.0023, var\"21102\" = 0.0, var\"21103\" = 0.00087, var\"21104\" = 0.00133, var\"21105\" = 0.00019, var\"21201\" = 0.0, var\"21202\" = 0.00061, var\"21203\" = 7.0e-5, var\"21204\" = 0.00733, var\"21205\" = 0.01055, var\"21301\" = 0.0, var\"21302\" = 0.07257, var\"21303\" = 0.11291, var\"21304\" = 0.03924, var\"21305\" = 0.08232)\n CSV.Row: (Column1 = 21302, var\"20601\" = 0.00787015740314806, var\"20602\" = 0.00351007020140403, var\"20603\" = 0.0142002840056801, var\"20604\" = 0.369757395147903, var\"20605\" = 0.0609312186243725, var\"20606\" = 0.0124502490049801, var\"20607\" = 0.0436408728174563, var\"20701\" = 0.0177103542070841, var\"20702\" = 0.00149002980059601, var\"20703\" = 0.00574011480229605, var\"20801\" = 0.00291005820116402, var\"20802\" = 0.00562011240224804, var\"20803\" = 0.00504010080201604, var\"20804\" = 0.00457009140182804, var\"20901\" = 0.00419008380167603, var\"20902\" = 0.00629012580251605, var\"20903\" = 0.000350007000140003, var\"20904\" = 0.00892017840356807, var\"21001\" = 0.0172403448068961, var\"21002\" = 0.000110002200044001, var\"21003\" = 0.00397007940158803, var\"21004\" = 0.00120002400048001, var\"21005\" = 0.0337206744134883, var\"21101\" = 0.00193003860077202, var\"21102\" = 0.000110002200044001, var\"21103\" = 0.000820016400328006, var\"21104\" = 0.00146002920058401, var\"21105\" = 0.000120002400048001, var\"21201\" = 0.000120002400048001, var\"21202\" = 0.000680013600272005, var\"21203\" = 0.000120002400048001, var\"21204\" = 0.00810016200324006, var\"21205\" = 0.0170303406068121, var\"21301\" = 0.0824916498329966, var\"21302\" = 0.0, var\"21303\" = 0.100682013640273, var\"21304\" = 0.0105402108042161, var\"21305\" = 0.144362887257745)\n CSV.Row: (Column1 = 21303, var\"20601\" = 0.0160395188144356, var\"20602\" = 0.00438986830395088, var\"20603\" = 0.0307390778276652, var\"20604\" = 0.44426667199984, var\"20605\" = 0.0596482105536834, var\"20606\" = 0.0170994870153895, var\"20607\" = 0.0639880803575893, var\"20701\" = 0.0196894093177205, var\"20702\" = 0.00177994660160195, var\"20703\" = 0.00702978910632681, var\"20801\" = 0.00313990580282592, var\"20802\" = 0.00591982240532784, var\"20803\" = 0.00488985330440087, var\"20804\" = 0.00489985300440987, var\"20901\" = 0.00587982360529184, var\"20902\" = 0.00866973990780277, var\"20903\" = 0.000559983200503985, var\"20904\" = 0.00797976060718178, var\"21001\" = 0.0243692689219323, var\"21002\" = 0.000329990100296991, var\"21003\" = 0.00690979270621881, var\"21004\" = 0.00134995950121496, var\"21005\" = 0.0404487865364039, var\"21101\" = 0.00324990250292491, var\"21102\" = 0.0, var\"21103\" = 0.000909972700818975, var\"21104\" = 0.00189994300170995, var\"21105\" = 0.000119996400107997, var\"21201\" = 0.0, var\"21202\" = 0.00073997780066598, var\"21203\" = 0.000239992800215994, var\"21204\" = 0.00639980800575983, var\"21205\" = 0.0139895803125906, var\"21301\" = 0.0773476795696129, var\"21302\" = 0.0611081667549973, var\"21303\" = 0.0, var\"21304\" = 0.00766976990690279, var\"21305\" = 0.0463086107416777)\n CSV.Row: (Column1 = 21304, var\"20601\" = 0.01214, var\"20602\" = 0.00331, var\"20603\" = 0.02227, var\"20604\" = 0.2209, var\"20605\" = 0.02803, var\"20606\" = 0.00583, var\"20607\" = 0.0298, var\"20701\" = 0.00897, var\"20702\" = 0.0013, var\"20703\" = 0.00384, var\"20801\" = 0.0011, var\"20802\" = 0.00198, var\"20803\" = 0.00346, var\"20804\" = 0.00122, var\"20901\" = 0.00548, var\"20902\" = 0.01073, var\"20903\" = 0.00047, var\"20904\" = 0.01783, var\"21001\" = 0.06302, var\"21002\" = 0.00666, var\"21003\" = 0.00993, var\"21004\" = 0.00909, var\"21005\" = 0.09037, var\"21101\" = 0.00175, var\"21102\" = 0.0, var\"21103\" = 0.00084, var\"21104\" = 0.00078, var\"21105\" = 0.00013, var\"21201\" = 0.0, var\"21202\" = 0.00112, var\"21203\" = 8.0e-5, var\"21204\" = 0.00574, var\"21205\" = 0.0089, var\"21301\" = 0.1878, var\"21302\" = 0.06818, var\"21303\" = 0.0698, var\"21304\" = 0.0, var\"21305\" = 0.09715)\n CSV.Row: (Column1 = 21305, var\"20601\" = 0.00730985380292394, var\"20602\" = 0.00252994940101198, var\"20603\" = 0.0137897242055159, var\"20604\" = 0.340703185936281, var\"20605\" = 0.0511389772204556, var\"20606\" = 0.0110597788044239, var\"20607\" = 0.0398592028159437, var\"20701\" = 0.0148797024059519, var\"20702\" = 0.00124997500049999, var\"20703\" = 0.00630987380252395, var\"20801\" = 0.00188996220075598, var\"20802\" = 0.00494990100197996, var\"20803\" = 0.00576988460230795, var\"20804\" = 0.00368992620147597, var\"20901\" = 0.00330993380132397, var\"20902\" = 0.00672986540269195, var\"20903\" = 0.000239995200095998, var\"20904\" = 0.00887982240355193, var\"21001\" = 0.0246895062098758, var\"21002\" = 0.000499990000199996, var\"21003\" = 0.00372992540149197, var\"21004\" = 0.00130997380052399, var\"21005\" = 0.0394292114157717, var\"21101\" = 0.00373992520149597, var\"21102\" = 0.0, var\"21103\" = 0.00161996760064799, var\"21104\" = 0.00227995440091198, var\"21105\" = 0.000289994200115998, var\"21201\" = 0.0, var\"21202\" = 0.000939981200375993, var\"21203\" = 0.0, var\"21204\" = 0.00826983460330794, var\"21205\" = 0.0157396852062959, var\"21301\" = 0.110207795844083, var\"21302\" = 0.160516789664207, var\"21303\" = 0.0781184376312474, var\"21304\" = 0.0243295134097318, var\"21305\" = 0.0)\n\n\nEpidemiological parameters\n\nr0 = 1.4\nσ = 2.0\nγ = 0.5\n\n0.5\n\n\nModel Parameters type\n\nstruct Params\n    β::Float64\n    σ::Float64\n    γ::Float64\n    popn::Vector #Vector of patches\n    mixmat::AbstractArray\nend\n\nThe rust code includes and ‘impl Params’ block hich I’m not sure is necessary\nModel State type\n\nstruct Model\n    params::Params\n    numpatch::Int\n    t::Float64\n    s::Vector\n    e::Vector\n    i::Vector\nend\n\nEvent type is an ‘enum’ which I’m not sure about. I cant make out what it does, but I’ll try and impliment it anyway\n\n@enum Event begin\n    Exposure = 0\n    Infection = 6 #why 6?\n    Recovery = 2\nend\n\nnext there is another ‘impl’ this time of the ‘Model’ type. I think what this is doing is specifying a way to interact with the model type. the first block is a public function ‘new’ which I guess generates a new model with the supplied parameters. AFAIK the way to do this is in julia just to define a function method for the model type\n\n\n\n\nMoss, R., Naghizade, E., Tomko, M., & Geard, N. (2019). What can urban mobility data reveal about the spatial distribution of infection in a single city? BMC Public Health, 19(1), 656. https://doi.org/10.1186/s12889-019-6968-x"
  },
  {
    "objectID": "Notes/Compartmental_Models_Markov_Chains.html",
    "href": "Notes/Compartmental_Models_Markov_Chains.html",
    "title": "4  SIS DTMC",
    "section": "",
    "text": "flowchart LR\n    S --> I\n    I --> S\n\n\n\nflowchart LR\n    S --> I\n    I --> S\n\n\n\n\n\n\n\n\nCan be described by a Markov chain of a random variable I(t) representing the number of individuals infected at time t.\n\ndigraph {\n    rankdir = \"LR\"\n    0 -> 0\n    1 -> 0\n    1 -> 2\n    2 -> 1\n    2 -> \"...\"\n    \"...\" -> 2\n    \"...\" -> N\n    N -> \"...\"\n}\n\n\n\n\n   \n\n0\n\n 0   \n\n0->0\n\n    \n\n1\n\n 1   \n\n1->0\n\n    \n\n2\n\n 2   \n\n1->2\n\n    \n\n2->1\n\n    \n\n…\n\n …   \n\n2->…\n\n    \n\n…->2\n\n    \n\nN\n\n N   \n\n…->N\n\n    \n\nN->…\n\n   \n\n\n\n\n\nNote that I(t) = 0 is an absorbing state (i.e. if there are no infectious people they cannot infect anyone). All other states {1,…, N} are transient.\nPossible transitions are specified by\n\np _ {ji} ( \\Delta t ) =\n     \\begin{cases}\n        {\\frac { \\beta i ( N - i ) } { N}} \\Delta t, & {j = i + 1 } \\\\\n        { \\gamma i \\Delta t}, & { j = i - 1 } \\\\\n        { 1 - \\bigg[ \\frac { \\beta i (N - i) } { N } +  \\gamma i }\\bigg] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n\\tag{4.1}\nWhich can be simplified to\n\np _ {ji} ( \\Delta t ) =\n    \\begin{cases}\n        b(i) \\Delta t, & {j = i + 1 } \\\\\n        d(i) \\Delta t, & { j = i - 1 } \\\\\n        1 - [ b(i)  + d(i)] \\Delta t, & { j = i } \\\\\n        0, & { j \\neq i +1, i, i-1}\n    \\end{cases}\n\\tag{4.2}\nThe probability of being in state i at time t + \\Delta t can be experessed in terms of probabilities at time t. \np_{i}(t + \\Delta t) =\n    p_{i-1}(t)b(i-1)\\Delta t +\n    p_{i+1}(t)d(i+1)\\Delta t +\n    p_{i}(t)(1- [ b(i)  + d(i)] \\Delta t)\n\nfor i = 1,2,..., N, where b(i) = \\beta (N-1/N), and d(i)= \\gamma i\nThe transition matrix P(\\Delta t) is given by \n\\begin{pmatrix}\n    1 & d(1)\\Delta t & 0 &  \\cdots & 0 & 0 \\\\\n    0  & 1-(b+d)(1)\\Delta t & d(2)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & b(1)\\Delta t & 1-(b+d)(1)\\Delta t &  \\cdots & 0 & 0 \\\\\n    0 & 0t & b(1)\\Delta &  \\cdots & 0 & 0 \\\\\n    \\vdots & \\vdots & \\vdots &  \\ddots & \\vdots & \\vdots \\\\\n    0 & 0  & 0 &  \\cdots & d(N-1) \\Delta t & 0 \\\\\n    0 & 0  & 0 &  \\cdots & 1-(b+d)(N-1)\\Delta t & d(N) \\Delta t \\\\\n    0 & 0  & 0 &  \\cdots & b(N-1)\\Delta t & 1- d(N) \\Delta t \\\\\n\\end{pmatrix}\n\n\n5 SIR DTMC\nThe compartmental model\n\nflowchart LR\n    S --> I\n    I --> R\n\n\n\nflowchart LR\n    S --> I\n    I --> R\n\n\n\n\n\n\n\n\nCan be described by a Markov chain of two independent random variables S(t) and I(t) representing the number of susceptible or individuals infected at time t, respectively (a third RV R(t) denoting the number of recovered individuals is fully determined when the population size is known, i.e. R = N - S - I).\n\np _ {(s +k, i +j),(s,i)}(\\Delta t) =\n     \\begin{cases}\n        {\\frac { \\beta i s} { N}} \\Delta t, & {(k, j) = (-1, 1) } \\\\\n        { \\gamma i \\Delta t}, & { (k, j) = (0, -1)  } \\\\\n        { 1 - \\bigg[ \\frac { \\beta i s } { N } +  \\gamma i }\\bigg] \\Delta t, & { (k, j) = (0, 0)} \\\\\n        0, & {otherwise}\n    \\end{cases}\n\\tag{5.1}\nEquation 4.1\n\ndigraph {\n    rankdir = \"TB\"\n\n    \"S = 0 \\n I = 1\" ->    \"S = 0 \\n I = 0\" [color = \"blue\"]\n    \"S = 0 \\n I = 2\" ->    \"S = 0 \\n I = 1\" [color = \"blue\"]\n    \"S = 0 \\n I = ~\" ->    \"S = 0 \\n I = 2\" [color = \"blue\"]\n    \"S = 0 \\n I = N\" ->    \"S = 0 \\n I = N - 1\" [color = \"blue\"]\n    \"S = 0 \\n I = N - 1\" -> \"S = 0 \\n I = N - 2\" [color = \"blue\"]\n    \"S = 0 \\n I = N - 2\" -> \"S = 0 \\n I = ~\" [color = \"blue\"]\n\n    \"S = 1 \\n I = 1\" ->    \"S = 0 \\n I = 2\"  [color = \"red\"]\n\n    \"S = 1 \\n I = 2\" ->    \"S = 1 \\n I = 1\" [color = \"blue\"]\n    \"S = 1 \\n I = 2\" ->    \"S = 0 \\n I = ~\" [color = \"red\"]\n\n    \"S = 1 \\n I = ~\" ->    \"S = 1 \\n I = 2\" [color = \"blue\"]\n    \"S = 1 \\n I = ~\" ->    \"S = 0 \\n I = ~\" [color = \"red\"]\n    \"S = 1 \\n I = ~\" ->    \"S = 0 \\n I = N - 1\" [color = \"red\"]\n\n    \"S = 1 \\n I = N - 1\" -> \"S = 1 \\n I = N - 2\" [color = \"blue\"]\n    \"S = 1 \\n I = N - 1\" -> \"S = 0 \\n I = N\" [color = \"red\"]\n\n    \"S = 1 \\n I = N - 2\" -> \"S = 0 \\n I = N - 1\" [color = \"red\"]\n    \"S = 1 \\n I = N - 2\" -> \"S = 1 \\n I = ~\" [color = \"blue\"]\n\n\n    \"S = 2 \\n I = 1\" ->    \"S = 1 \\n I = 2\" [color = \"red\"]\n    \"S = 2 \\n I = 1\" ->    \"S = 2 \\n I = 0\" [color = \"blue\"]\n\n    \"S = 2 \\n I = 2\" ->    \"S = 1 \\n I = ~\" [color = \"red\"]\n    \"S = 2 \\n I = 2\" ->    \"S = 2 \\n I = 1\" [color = \"blue\"]\n\n    \"S = 2 \\n I = ~\" ->    \"S = 1 \\n I = ~\" [color = \"red\"]\n    \"S = 2 \\n I = ~\" ->    \"S = 1 \\n I = N - 2\" [color = \"red\"]\n    \"S = 2 \\n I = ~\" ->    \"S = 2 \\n I = 2\" [color = \"blue\"]\n\n    \"S = 2 \\n I = N - 2\" -> \"S = 1 \\n I = N - 1\" [color = \"red\"]\n    \"S = 2 \\n I = N - 2\" -> \"S = 2 \\n I = ~\" [color = \"blue\"]\n    \n\n    \"S = ~ \\n I = 1\" ->    \"S = ~ \\n I = 0\" [color = \"blue\"]\n    \"S = ~ \\n I = 1\" ->    \"S = ~ \\n I = 2\" [color = \"red\"]\n    \"S = ~ \\n I = 1\" ->    \"S = 2 \\n I = 2\" [color = \"red\"]\n\n    \"S = ~ \\n I = 2\" ->    \"S = ~ \\n I = ~\" [color = \"red\"]\n    \"S = ~ \\n I = 2\" ->    \"S = 2 \\n I = ~\"  [color = \"red\"]\n    \"S = ~ \\n I = 2\" ->    \"S = ~ \\n I = 1\" [color = \"blue\"]\n\n    \"S = ~ \\n I = ~\" ->    \"S = 2 \\n I = ~\" [color = \"red\"]\n    \"S = ~ \\n I = ~\" ->    \"S = 2 \\n I = N - 2\" [color = \"red\"]\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = ~\"  [color = \"red\"]\n\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = ~\"  [color = \"blue\"]\n    \"S = ~ \\n I = ~\" ->    \"S = ~ \\n I = 2\" [color = \"blue\"]\n\n\n    \"S = N - 1 \\n I = 1\" ->    \"S = N - 2 \\n I = 2\" [color = \"red\"]\n    \"S = N - 1 \\n I = 1\" ->    \"S = N - 1\\n I = 0\"   [color = \"blue\"]\n\n    \"S = N - 2 \\n I = 1\" -> \"S = ~ \\n I = 2\" [color = \"red\"]\n    \"S = N - 2 \\n I = 1\" -> \"S = N - 2 \\n I = 0\" [color = \"blue\"]\n\n    \"S = N - 2 \\n I = 2\" -> \"S = ~ \\n I = ~\" [color = \"red\"]\n    \"S = N - 2 \\n I = 2\" -> \"S = N - 2 \\n I = 1\" [color = \"blue\"]\n}\n\n\n\n\n   \n\nS = 0 I = 1\n\n S = 0   I = 1   \n\nS = 0 I = 0\n\n S = 0   I = 0   \n\nS = 0 I = 1->S = 0 I = 0\n\n    \n\nS = 0 I = 2\n\n S = 0   I = 2   \n\nS = 0 I = 2->S = 0 I = 1\n\n    \n\nS = 0 I = ~\n\n S = 0   I = ~   \n\nS = 0 I = ~->S = 0 I = 2\n\n    \n\nS = 0 I = N\n\n S = 0   I = N   \n\nS = 0 I = N - 1\n\n S = 0   I = N - 1   \n\nS = 0 I = N->S = 0 I = N - 1\n\n    \n\nS = 0 I = N - 2\n\n S = 0   I = N - 2   \n\nS = 0 I = N - 1->S = 0 I = N - 2\n\n    \n\nS = 0 I = N - 2->S = 0 I = ~\n\n    \n\nS = 1 I = 1\n\n S = 1   I = 1   \n\nS = 1 I = 1->S = 0 I = 2\n\n    \n\nS = 1 I = 2\n\n S = 1   I = 2   \n\nS = 1 I = 2->S = 0 I = ~\n\n    \n\nS = 1 I = 2->S = 1 I = 1\n\n    \n\nS = 1 I = ~\n\n S = 1   I = ~   \n\nS = 1 I = ~->S = 0 I = ~\n\n    \n\nS = 1 I = ~->S = 0 I = N - 1\n\n    \n\nS = 1 I = ~->S = 1 I = 2\n\n    \n\nS = 1 I = N - 1\n\n S = 1   I = N - 1   \n\nS = 1 I = N - 1->S = 0 I = N\n\n    \n\nS = 1 I = N - 2\n\n S = 1   I = N - 2   \n\nS = 1 I = N - 1->S = 1 I = N - 2\n\n    \n\nS = 1 I = N - 2->S = 0 I = N - 1\n\n    \n\nS = 1 I = N - 2->S = 1 I = ~\n\n    \n\nS = 2 I = 1\n\n S = 2   I = 1   \n\nS = 2 I = 1->S = 1 I = 2\n\n    \n\nS = 2 I = 0\n\n S = 2   I = 0   \n\nS = 2 I = 1->S = 2 I = 0\n\n    \n\nS = 2 I = 2\n\n S = 2   I = 2   \n\nS = 2 I = 2->S = 1 I = ~\n\n    \n\nS = 2 I = 2->S = 2 I = 1\n\n    \n\nS = 2 I = ~\n\n S = 2   I = ~   \n\nS = 2 I = ~->S = 1 I = ~\n\n    \n\nS = 2 I = ~->S = 1 I = N - 2\n\n    \n\nS = 2 I = ~->S = 2 I = 2\n\n    \n\nS = 2 I = N - 2\n\n S = 2   I = N - 2   \n\nS = 2 I = N - 2->S = 1 I = N - 1\n\n    \n\nS = 2 I = N - 2->S = 2 I = ~\n\n    \n\nS = ~ I = 1\n\n S = ~   I = 1   \n\nS = ~ I = 1->S = 2 I = 2\n\n    \n\nS = ~ I = 0\n\n S = ~   I = 0   \n\nS = ~ I = 1->S = ~ I = 0\n\n    \n\nS = ~ I = 2\n\n S = ~   I = 2   \n\nS = ~ I = 1->S = ~ I = 2\n\n    \n\nS = ~ I = 2->S = 2 I = ~\n\n    \n\nS = ~ I = 2->S = ~ I = 1\n\n    \n\nS = ~ I = ~\n\n S = ~   I = ~   \n\nS = ~ I = 2->S = ~ I = ~\n\n    \n\nS = ~ I = ~->S = 2 I = ~\n\n    \n\nS = ~ I = ~->S = 2 I = N - 2\n\n    \n\nS = ~ I = ~->S = ~ I = 2\n\n    \n\nS = ~ I = ~->S = ~ I = ~\n\n    \n\nS = ~ I = ~->S = ~ I = ~\n\n    \n\nS = N - 1 I = 1\n\n S = N - 1   I = 1   \n\nS = N - 2 I = 2\n\n S = N - 2   I = 2   \n\nS = N - 1 I = 1->S = N - 2 I = 2\n\n    \n\nS = N - 1I = 0\n\n S = N - 1  I = 0   \n\nS = N - 1 I = 1->S = N - 1I = 0\n\n    \n\nS = N - 2 I = 2->S = ~ I = ~\n\n    \n\nS = N - 2 I = 1\n\n S = N - 2   I = 1   \n\nS = N - 2 I = 2->S = N - 2 I = 1\n\n    \n\nS = N - 2 I = 1->S = ~ I = 2\n\n    \n\nS = N - 2 I = 0\n\n S = N - 2   I = 0   \n\nS = N - 2 I = 1->S = N - 2 I = 0\n\n   \n\n\n\n\n\nThere are (N + 1)(N + 2)/2 ordered pairs of states (s, i)\n\nN = 100\nS = 0:N\nI = 0:N\n\nn = Int64((N+1)*(N+2)/2)\n\na = Base.product(S, I) |>  collect |> vec\nb = []\n\nfor i in a\n    if sum(i) <= N\n        push!(b, i)\n    end\nend\n\n\nusing NamedArrays\n\nnames = repr.(b)\n\np = NamedArray(fill(0, (n,n)), (names,names))\n\ntf = function(i, j,  param, N)\n    β, γ = param\n\n    iS, iI = i\n    jS, jI = j\n\n    if iS - jS == 1 && iI - jI == -1 ## Infection condition\n        pij = β*iS*iI/N\n    elseif  iS == jS  && iI - jI == 1\n        pij = γ*iI\n    elseif  iS == jS  && iI == jI \n        pij = - (β*iS*iI/N + γ*iI)\n    else \n        pij = 0.0\n    end\n    pij::Float64\nend\n\n#11 (generic function with 1 method)\n\n\n\nQ = [tf(i, j, [.5,.1], 100) for i = b, j = b]\nt = 25\nQt = Q*t\n\np0 = falses(lastindex(b))\np0[201] = 1\npt = exp(Qt)*p0\nusing ExponentialUtilities\npt2 = expv(t, Q, p0)\npt2[201]\n\n3.4663274126619643e-7"
  },
  {
    "objectID": "Notes/CTMC_SIR_Sim.html",
    "href": "Notes/CTMC_SIR_Sim.html",
    "title": "5  Gillespie simulation",
    "section": "",
    "text": "To begin, lets define the disease model.\nThe SIR compartmental model features 3 compartiments (Susceptible, Infectious, and Recovered) though which N individuals pass between (i.e. S + I + R = N) over time. To impliment this, lets define a type to represent the state of an SIR system at time t, X(t) = \\{S, I, R\\}.\n\n\nNamedTuple{(:t, :S, :I, :R), Tuple{Real, Int64, Int64, Int64}}\n\n\n\ndigraph SIR {\n    rankdir = \"LR\"\n    S->I\n    I->R\n}\n\n\n\n\n\n\nSIR\n\n  \n\nS\n\n S   \n\nI\n\n I   \n\nS->I\n\n    \n\nR\n\n R   \n\nI->R\n\n   \n\n\n\n\n\nLets initialise a population of N = 100 individuals, one of who is infected and the remaining 99 are Susceptible along with a data frame to record the state at time t = 0.\n\n\n\n1×4 DataFrameRowtSIRFloat64Int64Int64Int6410.09910\n\n\nIn an SIR system there are two possible events that can occur after a certain time \\Delta t: infection (i.e. an individual moves from the Susceptible compartment to the Infectious compartment) X(t + \\Delta t) = \\{s-1, i + 1, r\\} and recovery X(t + \\Delta t) = \\{s, i-1, r +1\\}. Lets define these as triples which we can add to our SIR_State variable\n\n\n(infection = [-1, 1, 0], recovery = [0, -1, 1])\n\n\nOnly one eveCTMC model of a SIR disease process. which event will occur? Epidemiologcal theory tells us that, assuming homogenous mixing of infectious and susceptible individuals there will be S \\times I opportunities for contact. Only a proportion of these opporunities will result in infection, so let the parameter \\beta, the ‘transmission rate’ modulate this.\n\n\n(β = 0.5, γ = 0.1)\n\n\nSimiularly, we’ll specify a constant parameter, \\lambda, which will modulate the rate of recovery. Lets define a ‘transition’ function which, given a state X(t) = \\{s, i,r\\} will return the ‘propensity’ of each event occurring\nOk thats enough setting up, lets simulate the evolution of the system throrugh time.\nDelta t will have an exponential distribution with parameter 1/\\sum{a+b}\n\n\n0.5973480865552511\n\n\nNext we need to determine which event will happen. The probability of a transition will be given by the proportion of the\n\n\n0.16806722689075632\n\n\nTo sample one event with probability weighting according to its relative propensity,\n\n\n\n2×4 DataFrameRowtSIRFloat64Int64Int64Int6410.0991020.5973489901\n\n\nWe’re going to want to run this stepping process a number of times, so lets repeat the process until some specified time (t_{end}) is reached\nlets plot the results for a clearer picture\n\n\n\n\n\nThe probability that a susceptible individual will become infected p_{s-1, i+1}\\leftarrow{s, i} = \\frac\nSince R = S+I -N, se can represent the state of the system with \\{S, I\\}, where S \\in \\{0,1, ... , N-I-R\\}, I \\in \\{0,1, ... , N-S-R\\}.\nfor example, when N = 3, we can represent the system with a graph:\nAs a discrete time process this Markov chain can be represented by the transition matrix \np = \\begin{bmatrix}\n\\end{bmatrix}\n\nlooks reasonable. How about in comparison to the deterministic ODE solution\n\n\n\n\n\nThey’re not identical but maybe this is to be expected given the small sample size. We could inrease the sample size (which extended to would equal the ODE), but lets instead perform the N = 100 simulation a few more times.\nFor convenience I’ll wrap the whole simulation in a function which takes initial conditions and parameters in and outputs the data\n\n\nSIR_sim (generic function with 1 method)\n\n\nand run this 100 times\nI’ll also remove any samples in which the epidemic does not spread (i.e. when i = 0 and s != 0)\n\n\n\n\n\nTo summarise our data, it will be useful to be able to produce the distribution of states (across a number of samples) at a particular time t. I’ll write a function to do this\n\n\n#46 (generic function with 1 method)\n\n\nWe can use this function to define an average over all the our samples throught the course of the simulation.\n\n\n\n\n\nWe can also check the distribution of states at any given time. lets check t = 15\n\n\n\n\n\nA nice snapshot, but maybe we should animate the progression\n\n\n[ Info: Saved animation to C:\\Users\\Reubender\\Documents\\Projects\\SCI499\\papers\\Thesis\\Notes\\tmp.gif\n\n\n\n\n\n\n\n[ Info: Saved animation to C:\\Users\\Reubender\\Documents\\Projects\\SCI499\\papers\\Thesis\\Notes\\tmp.gif"
  },
  {
    "objectID": "Notes/shapefiles.html",
    "href": "Notes/shapefiles.html",
    "title": "6  Maps and shapefiles in julia",
    "section": "",
    "text": "using Shapefile\n\nASGSdir = joinpath(datadir(),\"ASGS_GDA2020\")\n\n(AUS_SHP,\nGCCSA_SHP,\nMB_SHP,\nSA1_SHP,\nSA2_SHP,\nSA3_SHP,\nSA4_SHP, \nSTE_SHP) = Shapefile.Table.(joinpath.(joinpath(ASGSdir),\n                readdir(ASGSdir),\n                string.(replace.(readdir(ASGSdir), r\"_SHP\" => \"\"),\n                 \".shp\")))\n\n8-element Vector{Shapefile.Table{Union{Missing, Shapefile.Polygon}}}:\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 2 rows and the following 7 columns:\n    \ngeometry, AUS_CODE21, AUS_NAME21, CHG_FLAG21, CHG_LBL21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 35 rows and the following 11 columns:\n    \ngeometry, GCC_CODE21, GCC_NAME21, CHG_FLAG21, CHG_LBL21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 368286 rows and the following 20 columns:\n    \ngeometry, MB_CODE21, MB_CAT21, CHG_FLAG21, CHG_LBL21, SA1_CODE21, SA2_CODE21, SA2_NAME21, SA3_CODE21, SA3_NAME21, SA4_CODE21, SA4_NAME21, GCC_CODE21, GCC_NAME21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 61845 rows and the following 18 columns:\n    \ngeometry, SA1_CODE21, CHG_FLAG21, CHG_LBL21, SA2_CODE21, SA2_NAME21, SA3_CODE21, SA3_NAME21, SA4_CODE21, SA4_NAME21, GCC_CODE21, GCC_NAME21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 2473 rows and the following 17 columns:\n    \ngeometry, SA2_CODE21, SA2_NAME21, CHG_FLAG21, CHG_LBL21, SA3_CODE21, SA3_NAME21, SA4_CODE21, SA4_NAME21, GCC_CODE21, GCC_NAME21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 359 rows and the following 15 columns:\n    \ngeometry, SA3_CODE21, SA3_NAME21, CHG_FLAG21, CHG_LBL21, SA4_CODE21, SA4_NAME21, GCC_CODE21, GCC_NAME21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 108 rows and the following 13 columns:\n    \ngeometry, SA4_CODE21, SA4_NAME21, CHG_FLAG21, CHG_LBL21, GCC_CODE21, GCC_NAME21, STE_CODE21, STE_NAME21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n Shapefile.Table{Union{Missing, Shapefile.Polygon}} with 10 rows and the following 9 columns:\n    \ngeometry, STE_CODE21, STE_NAME21, CHG_FLAG21, CHG_LBL21, AUS_CODE21, AUS_NAME21, AREASQKM21, LOCI_URI21\n\n\nCreate an index of the SA3 regions in the Greater Melbourne GCC\n\nusing Tables\n\nGMelb_SA1_SHP,\nGMelb_SA2_SHP,\nGMelb_SA3_SHP,\nSGMelb_A4_SHP = (\n    SA1_SHP,\n    SA2_SHP,\n    SA3_SHP,\n    SA4_SHP) .|>\n     x -> Tables.subset(x, x.GCC_NAME21 .== \"Greater Melbourne\")\n\n(Tables.DictColumnTable with 11487 rows, 18 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA1_CODE21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA2_CODE21  Union{Missing, String}\n :SA2_NAME21  Union{Missing, String}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 361 rows, 17 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA2_CODE21  Union{Missing, String}\n :SA2_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 40 rows, 15 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA3_CODE21  Union{Missing, String}\n :SA3_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String}, Tables.DictColumnTable with 9 rows, 13 columns, and schema:\n :geometry    Union{Missing, Shapefile.Polygon}\n :SA4_CODE21  Union{Missing, String}\n :SA4_NAME21  Union{Missing, String}\n :CHG_FLAG21  Union{Missing, String}\n :CHG_LBL21   Union{Missing, String}\n :GCC_CODE21  Union{Missing, String}\n :GCC_NAME21  Union{Missing, String}\n :STE_CODE21  Union{Missing, String}\n :STE_NAME21  Union{Missing, String}\n :AUS_CODE21  Union{Missing, String}\n :AUS_NAME21  Union{Missing, String}\n :AREASQKM21  Union{Missing, Float64}\n :LOCI_URI21  Union{Missing, String})\n\n\n\nusing Plots\nGMelb_SA1_SHP.geometry |> plot"
  }
]