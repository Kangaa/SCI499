geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"))+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.4, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = NA)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
GMelb_SA4_colors <- ggplot_build(ggplot() |> geom_sf(data = Shapes$SA4, aes(fill = SA4_CODE21)))
GMelb_SA4_colors <- ggplot_build(ggplot() + geom_sf(data = Shapes$SA4, aes(fill = SA4_CODE21)))
ggplot_build(ggplot() + geom_sf(data = Shapes$SA4, aes(fill = SA4_CODE21)))
ggplot_build(ggplot() + geom_sf(data = Gmelb_Shapes$SA4, aes(fill = SA4_CODE21)))
ggplot_build(ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21)))
GMelb_SA4_colors <- ggplot_build(ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21)))
GMelb_SA4_plot <- ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21))
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot)
GMelb_SA4_plot <- ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21))
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot)
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data", "fill")
Gmelb_SA4_colors
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot)
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
Gmelb_SA4_colors
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.4, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[4]) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = NA)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
GMelb_SA4_colors[3]
ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
library(sf)
library(tidyverse)
Shapes <- list(SA1 = tibble(),
SA2 = tibble(),
SA3 = tibble(),
SA4 = tibble())
Shapes$SA1 <- read_sf("../../data/ASGS_GDA2020/SA1_2021_AUST_SHP_GDA2020/SA1_2021_AUST_GDA2020.shp")
Shapes$SA2 <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
Shapes$SA3 <- read_sf("../../data/ASGS_GDA2020/SA3_2021_AUST_SHP_GDA2020/SA3_2021_AUST_GDA2020.shp")
Shapes$SA4 <- read_sf("../../data/ASGS_GDA2020/SA4_2021_AUST_SHP_GDA2020/SA4_2021_AUST_GDA2020.shp")
GMelb_Shapes <- Shapes |>
map(\(x) filter(x, GCC_NAME21 == "Greater Melbourne"))
GMelb_SA4_plot <- ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21))
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
Gmelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.4, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[3]) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = NA)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
GMelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.4, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[3]) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = NA)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.4, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[8]) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = NA) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = NA)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = 2) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[8]) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), , fill = GMelb_SA4_colors[8]) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), , fill = GMelb_SA4_colors[8])+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[8], alpha = 0.5) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), , fill = GMelb_SA4_colors[8], alpha = 0.5) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), , fill = GMelb_SA4_colors[8], alpha = 0.5)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
```{r}
#| label: fig-MelbSAexaple
library(sf)
library(tidyverse)
Shapes <- list(SA1 = tibble(),
SA2 = tibble(),
SA3 = tibble(),
SA4 = tibble())
Shapes$SA1 <- read_sf("../../data/ASGS_GDA2020/SA1_2021_AUST_SHP_GDA2020/SA1_2021_AUST_GDA2020.shp")
Shapes$SA2 <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
Shapes$SA3 <- read_sf("../../data/ASGS_GDA2020/SA3_2021_AUST_SHP_GDA2020/SA3_2021_AUST_GDA2020.shp")
Shapes$SA4 <- read_sf("../../data/ASGS_GDA2020/SA4_2021_AUST_SHP_GDA2020/SA4_2021_AUST_GDA2020.shp")
GMelb_Shapes <- Shapes |>
map(\(x) filter(x, GCC_NAME21 == "Greater Melbourne"))
GMelb_SA4_plot <- ggplot() + geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21))
GMelb_SA4_colors <- ggplot_build(GMelb_SA4_plot) |>
pluck("data",1, "fill")
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 |> filter(SA3_NAME21 == "Maribyrnong"), fill = GMelb_SA4_colors[8], alpha = 0.5) +
geom_sf(data = GMelb_Shapes$SA2 |> filter(SA2_NAME21 == "Footscray"), fill = GMelb_SA4_colors[8], alpha = 0.5) +
geom_sf(data = GMelb_Shapes$SA1 |>  filter(SA1_CODE21 == "21303134811"), fill = GMelb_SA4_colors[8], alpha = 0.5)+
coord_sf(xlim = c(144.8, 145) , ylim = c(-37.75, -37.9))
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 ) +
geom_sf(data = GMelb_Shapes$SA2 ) +
geom_sf(data = GMelb_Shapes$SA1)
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 ) +
geom_sf(data = GMelb_Shapes$SA2 ) +
geom_sf(data = GMelb_Shapes$SA1 )
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 ) +
geom_sf(data = GMelb_Shapes$SA2, lty = dotted)
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3 fill = NA) +
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA) +
geom_sf(data = GMelb_Shapes$SA2, lty = dotted, fill = NA)
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = NA) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA) +
geom_sf(data = GMelb_Shapes$SA2, lty = "dotted", fill = NA)
#| label: fig-GmelbSA2SA3SA4
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = 1) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA) +
geom_sf(data = GMelb_Shapes$SA2, lty = "dotted", fill = NA)
#| label: fig-GmelbSA2SA3SA4
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = 1) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA, linewidth = 0.5) +
geom_sf(data = GMelb_Shapes$SA2, lty = "dotted", fill = NA, linewidth = 0.5)
#| label: fig-GmelbSA2SA3SA4
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = 1) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA, linewidth = 0.5) +
geom_sf(data = GMelb_Shapes$SA2, lty = "dash", fill = NA, linewidth = 0.3)
#| label: fig-GmelbSA2SA3SA4
ggplot() +
geom_sf(data = GMelb_Shapes$SA4, aes(fill = SA4_CODE21), alpha = 0.5, linewidth = 1) +
geom_sf(data = GMelb_Shapes$SA3, fill = NA, linewidth = 0.5) +
geom_sf(data = GMelb_Shapes$SA2, lty = "dashed", fill = NA, linewidth = 0.3)
library(tidyverse)
#| echo: false
#| warning: false
library(tidyverse)
library(sf)
SA2_Popns <- read_csv("../../data/GmelbSA2Pop21.csv")
SA2_MMpop <- matrix(NA, nrow(SA2_Popns), nrow(SA2_Popns) )
seq_along(SA2_Popns)
seq_along(SA2_MMpop)
seq_along(SA2_MMpop[1,])
Ntot = sum(SA2_Popns$Pop)
Ntot
for (i in seq_along(SA2_MMpop[1,])){
for (j in seq_along(SA2_MMpop[,1])){
SA2_MMpop[i,j] <- SA2_Popns$Pop[j]/Ntot
}
}
SA2_Popns <- read_csv("../../data/GmelbSA2Pop21.csv")
SA2_MMpop <- matrix(NA,
nrow(SA2_Popns),
nrow(SA2_Popns),
dimnames = list(SA2_Popns$SA2_Name,
SA2_Popns$SA2_Code))
Ntot = sum(SA2_Popns$Pop)
for (i in seq_along(SA2_MMpop[1,])){
for (j in seq_along(SA2_MMpop[,1])){
SA2_MMpop[i,j] <- SA2_Popns$Pop[j]/Ntot
}
}
SA2_MMpop
sum(SA2_MMpop[1,])
sum(SA2_MMpop[,1])
tibble(expand_grid(1:nrow(SA2_Popns),1:nrow(SA2_Popns)))
ggplot(SA2_MMpop)+
geom_tile()
SA2_MMpop |>
as_tibble()
rownames_to_column(SA2_MMpop)
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix")
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(fill= mix))
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = ifill= mix))
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix))
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_color_continuous("viridis")
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_color_continuous(type = "viridis")
SA2_MMpop |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_fill_continuous(type = "viridis")
map(c("2", "3", "4"), \(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x) )
Gmelb_Popns <- map(map(c("2", "3", "4"), \(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x), read_csv)
Gmelb_Popns <- map(map(c("2", "3", "4"), \(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x), read_csv))
Gmelb_Popns <- map(map(c("2", "3", "4"), \(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x)), read_csv)
Gmelb_Popns
Gmelb_Popns <- map(map(c("2", "3", "4"), \(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x)), read_csv) |>
`names<-`(c("SA2", "SA3", "SA4"))
Gmelb_Popns
Gmelb_Popns <- map(
map(
c("2", "3", "4"),
\(x) str_replace("../../data/GmelbSA_X_Pop21.csv", "_X_", x)),
read_csv) |>
`names<-`(c("SA2", "SA3", "SA4"))
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x) matrix(NA, nrow(Gmelb_Popns$x)))
Gmelb_Popns
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x) matrix(NA, nrow(Gmelb_Popns[[x]])))
MMpops
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
} matrix(NA, size, size,
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA, size, size,
dimnames = list(Gmelb_Popns[[paste0(x), "_Code"]],
Gmelb_Popns[[paste0(x), "_Code"]]))})
matrix(NA, size, size,
dimnames = list(Gmelb_Popns[paste0(x), "_Code"],
Gmelb_Popns[paste0(x), "_Code"]))})
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA, size, size,
dimnames = list(Gmelb_Popns[paste0(x), "_Code"],
Gmelb_Popns[paste0(x), "_Code"]))})
Gmelb_Popns[SA2_Code]
Gmelb_Popns["SA2_Code"]
Gmelb_Popns
Gmelb_Popns$SA2["SA2_Code"]
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA, size, size,
dimnames = list(Gmelb_Popns[[x]][paste0(x), "_Code"],
Gmelb_Popns[[x]][paste0(x), "_Code"]))})
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA, size, size,
dimnames = list(Gmelb_Popns[[x]][paste0(x), "_Code"],
Gmelb_Popns[[x]][paste0(x), "_Code"]))})
matrix(NA,
size,
size,
dimnames = list(Gmelb_Popns[[x]][paste0(x, "_Code")],
Gmelb_Popns[[x]][paste0(x, "_Code")])})
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA,
size,
size,
dimnames = list(Gmelb_Popns[[x]][paste0(x, "_Code")],
Gmelb_Popns[[x]][paste0(x, "_Code")]))})
Gmelb_Popns[["SA2"]]["SA2_Code"]
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][paste0(x, "_Code")],
Gmelb_Popns[[x]][paste0(x, "_Code")]))})
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))})
MMpops
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]])),
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]]$pop)
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- Popns[[x]]$Pop[j]/Ntot
}
}
})
MMpop[i,j] <- GMelb_Popns[[x]]$Pop[j]/Ntot
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]]$pop)
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- GMelb_Popns[[x]]$Pop[j]/Ntot
}
}
})
MMpop[i,j] <- Gmelb_Popns[[x]]$Pop[j]/Ntot
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]]$pop)
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- Gmelb_Popns[[x]]$Pop[j]/Ntot
}
}
})
Gmelb_Popns
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]]$pop)
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- Gmelb_Popns[[x]][[3]][j]/Ntot
}
}
})
Ntot = sum(Gmelb_Popns[[x]][[3]])
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]][[3]])
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- Gmelb_Popns[[x]][[3]][j]/Ntot
}
}
})
MMpops
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]][[3]])
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- Gmelb_Popns[[x]][[3]][j]/Ntot
}
}
MMpop
})
MMpops
map(MMpops, \(x) x |>
map(MMpops, \(x){ x |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_fill_continuous(type = "viridis")})
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]][[3]])
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- (Gmelb_Popns[[x]][[3]][j]*Gmelb_Popns[[x]][[3]][i])/Ntot
}
}
MMpop
})
map(MMpops, \(x){ x |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_fill_continuous(type = "viridis")})
MMpop[i,j] <- (Gmelb_Popns[[x]][[3]][j]+Gmelb_Popns[[x]][[3]][i])/Ntot
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]][[3]])
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- (Gmelb_Popns[[x]][[3]][j]+Gmelb_Popns[[x]][[3]][i])/Ntot
}
}
MMpop
})
map(MMpops, \(x){ x |>
as_tibble(rownames = "i") |>
pivot_longer(-i, names_to = "j", values_to = "mix") |>
ggplot()+
geom_tile(aes(x = j, y = i,fill= mix)) +
scale_fill_continuous(type = "viridis")})
MMpops[[4]]
MMpops[[3]]
MMpops[[3]][1,]
MMpops[[3]][1,] |> sum()
MMpops[[3]][,1] |> sum()
MMpops <- map(c("SA2", "SA3", "SA4"),
\(x){
size <- nrow(Gmelb_Popns[[x]])
MMpop <- matrix(NA,
size,
size,
dimnames = list(
Gmelb_Popns[[x]][[paste0(x, "_Code")]],
Gmelb_Popns[[x]][[paste0(x, "_Code")]]))
Ntot = sum(Gmelb_Popns[[x]][[3]])
for (i in seq_along(MMpop[1,])){
for (j in seq_along(MMpop[,1])){
MMpop[i,j] <- (Gmelb_Popns[[x]][[3]][j]+Gmelb_Popns[[x]][[3]][i])/(2*Ntot)
}
}
MMpop
})
MMpops[[3]][,1] |> sum()
