SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- SA2_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 2)
SA2_sims |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free") +
labs(color = "mu")
SA2_sims |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(mu~R0, scales = "free") +
labs(color = "mu")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free") +
labs(color = "mu")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both()) +
labs(color = "mu")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both())
facet_grid(R0~mu, scales = "free", labeller = label_both
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
theme(legend.position = "none")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
theme(legend.position = "none")+
xlab("days")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
theme(legend.position = "none")+
xlab("time(days)") +
ylab("n infected individuals")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
theme(legend.position = "none")+
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw()
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
theme(legend.position = "none")+
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none")
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none") +
scale_x_continuous(breaks = c(0, 50, 100))
SA2_sims|>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mm) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mm, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
SA2_sims|>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
SA3_files <- list.files("../../data/sims/SA3", full.names = TRUE)
SA3_tot_files <- SA3_files[!str_detect(SA3_files, "patchinf|patchsus|summary")]
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mm = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mm = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mm, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mm) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mm, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
ggplot() +
aes(x = t, y = I, col = mm, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
SA3_sims
SA2_sims
SA3_sims
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
ggplot() +
aes(x = t, y = I, col = mm, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 == 1.4) |>
group_by(sim, SA, R0, mm) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = fin, col = SA, group = sim) +
geom_histogram(bins = 100) +
facet_grid(mm ~ SA)
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 == 1.4) |>
group_by(sim, SA, R0, mu) |>
sumuarise(fin = min(S)) |>
ggplot() +
aes(x = fin, col = SA, group = sim) +
geom_histogram(bins = 100) +
facet_grid(mu ~ SA)
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 == 1.4) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = fin, col = SA, group = sim) +
geom_histogram(bins = 100) +
facet_grid(mu ~ SA)
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 == 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = fin, col = SA, group = sim) +
geom_histogram(bins = 100) +
facet_grid(mu ~ SA)
read_csv("../../data/sims/SA2/SA2_1.0_1.0_0.2_patchinf_77.csv")
SA2_shapefile <- read_sf("data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
infs <- read_csv("../../data/sims/SA2/SA2_1.0_1.0_0.2_patchinf_77.csv")
SA2_shapefile <- read_sf("data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
SA2_shapefile <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
SA2_shapefile
ggplot() +
geom_sf(data = melb_shp_SA2)
melb_shp_SA2 <- SA2_shapefile |>
filter(GCC_CODE21 == "2GMEL")
ggplot() +
geom_sf(data = melb_shp_SA2)
ggplot() +
geom_sf(data = melb_shp_SA2, aes(col = infs[1,]))
max(infs)
infs <- read_csv("../../data/sims/SA2/SA2_1.5_1.0_0.2_patchinf_77.csv")
infs <- read_csv("../../data/sims/SA2/SA2_1.6_1.0_0.2_patchinf_77.csv")
SA2_shapefile <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
melb_shp_SA2 <- SA2_shapefile |>
filter(GCC_CODE21 == "2GMEL")
max(infs)
infs_sc <- infs/max(infs)
infs_sc
infs_sc <- log1p(infs/max(infs))
infs_sc
infs_sc <- log1p(infs/max(infs))
ggplot() +
geom_sf(data = melb_shp_SA2)) +
infs_sc
ggplot() +
geom_sf(data = melb_shp_SA2, aes(col = infs_sc[1,])) +
scaleco
ggplot() +
geom_sf(data = melb_shp_SA2, aes(col = infs_sc[1,]))
ggplot() +
geom_sf(data = melb_shp_SA2, aes(fill = infs_sc[1,]))
View(infs_sc)
infs_sc |>
mutate(t = row_number())
View(infs_sc)
infs_sc <- log1p(infs/max(infs)) |>
mutate(t = row_number())
View(infs_sc)
infs_sc <- log1p(infs/max(infs)) |>
mutate(t = row_number()) |>
pivot_longer(-t, names_to = "SA2_NAME21", values_to = "infections")
infs_sc
infs_sc[t==1]
infs_sc[infs_sct==1, ]
infs_sc[infs_sc$t==1, ]
melb_shp_SA2 |>
left_join(infs_sc[infs_sc$t==1, ], by = SA2_NAME21)
infs_sc
melb_shp_SA2
melb_shp_SA2 |>
left_join(infs_sc[infs_sc$t==1, ], by = "SA2_NAME21")
melb_shp_SA2 |>
left_join(infs_sc[infs_sc$t==1, ], by = "SA2_NAME21")
ggplot() +
geom_sf(data = melb_shp_SA2, aes(fill =infections))
ggplot() +
geom_sf(data = melb_shp_SA2 |>
left_join(infs_sc[infs_sc$t==1, ], by = "SA2_NAME21"),
aes(fill =infections))
melb_shp_SA2 |>
left_join(infs_sc, by = "SA2_NAME21")
anim = melb_shp_SA2 |>
left_join(infs_sc, by = "SA2_NAME21")
install.packages("gganimate")
library(gganimate)
install.packages("gifski")
SA2_files <- list.files("../../data/sims/SA2", full.names = TRUE)
SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
infs <- read_csv("../../data/sims/SA2/SA2_1.6_1.0_0.2_patchinf_77.csv")
library(tidyverse)
infs <- read_csv("../../data/sims/SA2/SA2_1.6_1.0_0.2_patchinf_77.csv")
SA2_shapefile <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
library(sf)
SA2_shapefile <- read_sf("../../data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
melb_shp_SA2 <- SA2_shapefile |>
filter(GCC_CODE21 == "2GMEL")
infs_sc <- log1p(infs/max(infs)) |>
mutate(t = row_number()) |>
pivot_longer(-t, names_to = "SA2_NAME21", values_to = "infections")
infs_sc[infs_sc$t==1, ]
anim = melb_shp_SA2 |>
left_join(infs_sc, by = "SA2_NAME21")
library(gganimate)
ggplot() +
geom_sf(data = melb_shp_SA2 |>
left_join(infs_sc[infs_sc$t==1, ], by = "SA2_NAME21"),
aes(fill =infections))
ggplot() +
geom_sf(data =anim, by = "SA2_NAME21"),
geom_sf(data =anim,aes(fill =infections) +
ggplot() +
geom_sf(data =anim,aes(fill =infections)) +
transition_time(t)
install.packages("transformr")
ggplot() +
geom_sf(data =anim,aes(fill =infections)) +
transition_time(t)
remove.packages("transformr")
install.packages("https://cran.r-project.org/src/contrib/Archive/transformr/transformr_0.1.3.tar.gz", repos = NULL, type = "source")
ggplot() +
geom_sf(data =anim,aes(fill =infections)) +
transition_time(t)
remove.packages("transformr")
install.packages("https://cran.r-project.org/src/contrib/Archive/transformr/transformr_0.1.3.tar.gz", repos = NULL, type = "source")
library(tidyverse)
library(sf)
SA2_shapefile <- read_sf("data/ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")
SA1_shapefile <- read_sf("data/ASGS_GDA2020/SA1_2021_AUST_SHP_GDA2020/SA1_2021_AUST_GDA2020.shp")
NSW <- SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
summarise(geom = st_union(geometry))
NE <- SA2_shapefile |>
filter(SA4_NAME21 == "New England and North West") |>
summarise(geom = st_union(geometry))
Armidale <- SA2_shapefile |>
filter(SA3_NAME21 == "Armidale") |>
summarise(geom = st_union(geometry))
Armidale_SA1 <- SA1_shapefile |>
filter(SA2_NAME21 == "Armidale")
Armidale
NE
NSW <- SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
summarise(geom = st_union(geometry))
NE <- SA2_shapefile |>
filter(SA4_NAME21 == "New England and North West") |>
summarise(geom = st_union(geometry))
Armidale <- SA2_shapefile |>
filter(SA3_NAME21 == "Armidale") |>
summarise(geom = st_union(geometry))
Armidale_SA2 <- SA2_shapefile |>
filter(SA2_NAME21 == "Armidale")
Armidale_SA1 <- SA1_shapefile |>
filter(SA2_NAME21 == "Armidale")
ggplot() +
geom_sf(data = NSW) +
geom_sf(data = NE) +
geom_sf(data = Armidale) +
geom_sf(data = Armidale_SA2)
ggplot() +
geom_sf(data = NSW, fill = "lightblue") +
geom_sf(data = NE) +
geom_sf(data = Armidale) +
geom_sf(data = Armidale_SA2)
ggplot() +
geom_sf(data = NSW, fill = "lightblue")
NSW_SA4 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA4_NAME21) |>
summarise(geom = st_union(geometry)))
NSW_SA4
NSW_SA3 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA3_NAME21) |>
summarise(geom = st_union(geometry)))
filter(STE_NAME21 == "New South Wales")
NSW_SA2 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales"))
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue")
A2 <- ggplot() +
geom_sf(data = NSW_SA4) +
geom_sf(data = NE, fill = "lightblue")
A3 <- ggplot() +
geom_sf(data = NSW_SA3) +
geom_sf(data = Armidale, fill = "lightblue")
Armidale_SA2
Armidale
Armidale_SA2
NSW <- SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
summarise(geom = st_union(geometry))
NE <- SA2_shapefile |>
filter(SA4_NAME21 == "New England and North West") |>
summarise(geom = st_union(geometry))
Armidale <- SA2_shapefile |>
filter(SA3_NAME21 == "Armidale") |>
summarise(geom = st_union(geometry))
Armidale_SA2 <- SA2_shapefile |>
filter(SA2_NAME21 == "Armidale")
Armidale_SA1 <- SA1_shapefile |>
filter(SA2_NAME21 == "Armidale")
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue")
A2 <- ggplot() +
geom_sf(data = NSW_SA4) +
geom_sf(data = NE, fill = "lightblue")
ggplot() +
geom_sf(data = NSW_SA4)
NSW_SA4
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")
A2
A3 <- NSW_SA3 +
geom_sf(data = Armidale, fill = "lightblue")
A4 <- NSW_SA2 +
geom_sf(data = Armidale_SA2, fill = "lightblue")
A3
A4
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue") +
labs(title = "SA4")
A1
ggsave("../../plots/Armidale_NSW.svg", A1)
ggsave("plots/Armidale_NSW.svg", A1)
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")+
labs(title = "SA4")
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")+
labs(title = "SA4")
ggsave("plots/Armidale_SA4.svg", A2)
ggsave("plots/Armidale_SA4.svg", A2)
A3 <- NSW_SA3 +
geom_sf(data = Armidale, fill = "lightblue")+
labs(title = "SA3")
ggsave("plots/Armidale_SA3.svg", A3)
A4 <- NSW_SA2 +
geom_sf(data = Armidale_SA2, fill = "lightblue")+
labs(title = "SA2")
ggsave("plots/Armidale_SA2.svg", A4)
ggsave("plots/Armidale_NSW.svg", A1)
SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA4_NAME21) |>
summarise(geom = st_union(geometry))
