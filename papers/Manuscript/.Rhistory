NE
NSW <- SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
summarise(geom = st_union(geometry))
NE <- SA2_shapefile |>
filter(SA4_NAME21 == "New England and North West") |>
summarise(geom = st_union(geometry))
Armidale <- SA2_shapefile |>
filter(SA3_NAME21 == "Armidale") |>
summarise(geom = st_union(geometry))
Armidale_SA2 <- SA2_shapefile |>
filter(SA2_NAME21 == "Armidale")
Armidale_SA1 <- SA1_shapefile |>
filter(SA2_NAME21 == "Armidale")
ggplot() +
geom_sf(data = NSW) +
geom_sf(data = NE) +
geom_sf(data = Armidale) +
geom_sf(data = Armidale_SA2)
ggplot() +
geom_sf(data = NSW, fill = "lightblue") +
geom_sf(data = NE) +
geom_sf(data = Armidale) +
geom_sf(data = Armidale_SA2)
ggplot() +
geom_sf(data = NSW, fill = "lightblue")
NSW_SA4 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA4_NAME21) |>
summarise(geom = st_union(geometry)))
NSW_SA4
NSW_SA3 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA3_NAME21) |>
summarise(geom = st_union(geometry)))
filter(STE_NAME21 == "New South Wales")
NSW_SA2 <- ggplot() +
geom_sf(data = SA2_shapefile |>
filter(STE_NAME21 == "New South Wales"))
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue")
A2 <- ggplot() +
geom_sf(data = NSW_SA4) +
geom_sf(data = NE, fill = "lightblue")
A3 <- ggplot() +
geom_sf(data = NSW_SA3) +
geom_sf(data = Armidale, fill = "lightblue")
Armidale_SA2
Armidale
Armidale_SA2
NSW <- SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
summarise(geom = st_union(geometry))
NE <- SA2_shapefile |>
filter(SA4_NAME21 == "New England and North West") |>
summarise(geom = st_union(geometry))
Armidale <- SA2_shapefile |>
filter(SA3_NAME21 == "Armidale") |>
summarise(geom = st_union(geometry))
Armidale_SA2 <- SA2_shapefile |>
filter(SA2_NAME21 == "Armidale")
Armidale_SA1 <- SA1_shapefile |>
filter(SA2_NAME21 == "Armidale")
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue")
A2 <- ggplot() +
geom_sf(data = NSW_SA4) +
geom_sf(data = NE, fill = "lightblue")
ggplot() +
geom_sf(data = NSW_SA4)
NSW_SA4
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")
A2
A3 <- NSW_SA3 +
geom_sf(data = Armidale, fill = "lightblue")
A4 <- NSW_SA2 +
geom_sf(data = Armidale_SA2, fill = "lightblue")
A3
A4
A1 <- ggplot() +
geom_sf(data = NSW, fill = "lightblue") +
labs(title = "SA4")
A1
ggsave("../../plots/Armidale_NSW.svg", A1)
ggsave("plots/Armidale_NSW.svg", A1)
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")+
labs(title = "SA4")
A2 <- NSW_SA4 +
geom_sf(data = NE, fill = "lightblue")+
labs(title = "SA4")
ggsave("plots/Armidale_SA4.svg", A2)
ggsave("plots/Armidale_SA4.svg", A2)
A3 <- NSW_SA3 +
geom_sf(data = Armidale, fill = "lightblue")+
labs(title = "SA3")
ggsave("plots/Armidale_SA3.svg", A3)
A4 <- NSW_SA2 +
geom_sf(data = Armidale_SA2, fill = "lightblue")+
labs(title = "SA2")
ggsave("plots/Armidale_SA2.svg", A4)
ggsave("plots/Armidale_NSW.svg", A1)
SA2_shapefile |>
filter(STE_NAME21 == "New South Wales") |>
group_by(SA4_NAME21) |>
summarise(geom = st_union(geometry))
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
library(tidyverse)
SA2_files <- list.files("../../data/sims/SA2", full.names = TRUE)
SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- SA2_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 2)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none") +
scale_x_continuous(breaks = c(0, 50, 100))
ggplot() +
aes(x = t, y = pop)+
geom_line(data = SA2_sims |>
filter(R0 == 1.8, mm == 0.1) |>
pivot_longer(c(S,I), names_to = "compartment", values_to = "pop") |>
filter(compartment == "S"),
aes(group = sim, col = compartment),  alpha = 0.1) +
geom_line(data = SA2_sims |>
filter(R0 == 1.8, mm == 0.1) |>
pivot_longer(c(S,I), names_to = "compartment", values_to = "pop") |>
filter(compartment == "I"),
aes(group = sim, col = compartment), alpha = 0.1)
SA3_files <- list.files("../../data/sims/SA3", full.names = TRUE)
SA3_tot_files <- SA3_files[!str_detect(SA3_files, "patchinf|patchsus|summary")]
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA4_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
)
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 4)
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
SA2_files <- list.files("../../data/sims/SA2", full.names = TRUE)
SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- SA2_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 2)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none") +
scale_x_continuous(breaks = c(0, 50, 100))
SA3_files <- list.files("../../data/sims/SA3", full.names = TRUE)
SA3_tot_files <- SA3_files[!str_detect(SA3_files, "patchinf|patchsus|summary")]
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 4)
SA4_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = SA) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = factor(SA)) +
geom_point() +
facet_grid(~ R0, scales = "free")
SA2_files <- list.files("../../data/sims/SA2", full.names = TRUE)
SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- SA2_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 2)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none") +
scale_x_continuous(breaks = c(0, 50, 100))
SA3_files <- list.files("../../data/sims/SA3", full.names = TRUE)
SA3_tot_files <- SA3_files[!str_detect(SA3_files, "patchinf|patchsus|summary")]
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 4)
SA4_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 <= 2) |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_grid(SA ~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = factor(SA)) +
geom_point() +
facet_grid(~ R0, scales = "free")
library(tidyverse)
SA2_files <- list.files("../../data/sims/SA2", full.names = TRUE)
SA2_tot_files <- SA2_files[!str_detect(SA2_files, "patchinf|patchsus|summary")]
SA2_sims <- read_csv(SA2_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA2_sims <- SA2_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 2)
SA2_sims |>
filter(R0 == 1.2 | R0 == 1.6 | R0 == 2) |>
ggplot() +
aes(x = t, y = I, col = factor(mu), group = sim) +
geom_line() +
facet_grid(R0~mu, scales = "free", labeller = label_both) +
xlab("time(days)") +
ylab("n infected individuals") +
theme_bw(base_size = 14) +
theme(legend.position = "none") +
scale_x_continuous(breaks = c(0, 50, 100))
SA3_files <- list.files("../../data/sims/SA3", full.names = TRUE)
SA3_tot_files <- SA3_files[!str_detect(SA3_files, "patchinf|patchsus|summary")]
SA3_sims <- read_csv(SA3_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA3_sims <- SA3_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3)
SA3_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
SA4_files <- list.files("../../data/sims/SA4", full.names = TRUE)
SA4_tot_files <- SA4_files[!str_detect(SA4_files, "patchinf|patchsus|summary")]
SA4_sims <- read_csv(SA4_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
SA4_sims <- SA4_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_.{3}_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_.{3}_.{1,3}.csv", group = 1)),
mu = as.numeric(str_extract(sim, "(...)_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 4)
SA4_sims |>
ggplot() +
aes(x = t, y = I, col = mu, group = sim) +
geom_line() +
facet_wrap(~R0, scales = "free")
Moss_files <- list.files("C:/Users/reubender/Downloads/Moss", full.names = TRUE)
Moss_tot_files <- Moss_files[!str_detect(Moss_files, "patchinf|patchsus|summary")]
Moss_sims <- read_csv(Moss_tot_files, col_names = c("t", "S", "I"), skip = 2, id = "sim")
Moss_sims <- Moss_sims |>
mutate(
beta = as.numeric(str_extract(sim, "(...)_.{3}_Moss_.{1,3}.csv", group = 1)),
gamma = as.numeric(str_extract(sim, "(...)_Moss_.{1,3}.csv", group = 1)),
R0 = beta/gamma,
SA = 3,
mm = "Moss")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = factor(SA)) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = factor(SA), size = 0.1) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims,
SA4_sims
) |>
filter(R0 >= 1) |>
group_by(sim, SA, R0, mu) |>
summarise(fin = min(S)) |>
ggplot() +
aes(x = mu, y = fin, col = factor(SA)) +
geom_point(size = 0.1) +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
group_by(sim, SA, R0, mm) |>
summarise(duration = max(t)) |>
ggplot() +
aes(x = mm, y = duration, col = factor(SA), alpha = 0.5) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
group_by(sim, SA, R0, mu) |>
summarise(duration = max(t)) |>
ggplot() +
aes(x = mu, y = duration, col = factor(SA), alpha = 0.5) +
geom_point() +
facet_grid(~ R0, scales = "free")
rbind(SA2_sims,
SA3_sims
) |>
filter(R0 <= 2, R0 > 1) |>
group_by(sim, SA, R0, mu) |>
summarise(duration = max(t)) |>
ggplot() +
aes(x = factor(mu), y = duration, col = factor(SA), alpha = 0.5) +
geom_boxplot() +
facet_grid(~ R0, scales = "free")
renv
library(renv)
View(config)
View(config)
?renv
renv::repair()
renv::update
renv::update()
