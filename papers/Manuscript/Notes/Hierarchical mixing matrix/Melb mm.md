This can be extended to greater levels of hierarchy. As a real world example, we can look at a a small group of suburbs in the greater melbourne region.


```julia
using DrWatson @quickactivate using Shapefile using Tables using Plots include(srcdir("SpatialSEIR_module.jl")) using .SpatialSEIRutils.MixingMatrices AUS_SA2_SHP = Shapefile.Table(datadir("ASGS_GDA2020/SA2_2021_AUST_SHP_GDA2020/SA2_2021_AUST_GDA2020.shp")) GMelb_SA2_SHP = Tables.subset(AUS_SA2_SHP, AUS_SA2_SHP.GCC_NAME21 .== "Greater Melbourne") SA_Codes = MixingMatrices.getCodes(GMelb_SA2_SHP) SA2_names = GMelb_SA2_SHP.SA2_NAME21 Demo = Tables.subset(GMelb_SA2_SHP, findall( x -> ( x == "Flemington" || x == "Ascot Vale" || x == "West Melbourne - Industrial" || x == "Flemington Racecourse" || x == "Kensington (Vic.)" || x == "Footscray"|| x == "Maribyrnong"), SA2_names)) SA3_cols = Dict(zip(Demo.SA3_NAME21|>unique, palette(:tab10, Demo.SA3_CODE21|>unique) )) plot(Demo.geometry, color = collect(Demo.SA3_NAME21.|> x -> get(SA3_cols, x, "null"))')
```

Kensington, Racecourse, and West industrial are SA2 regions within the 'Melbourne City' SA3 region, Footscray and Maribyrnong are SA2 regions within the 'Maribyrnong' SA3 region, and Flemington and Ascot Vale are SA2 regions withing the 'Essendon' SA3 region. Furthermore, both 'Melbnourne city' and Essendon are within the 'Inner Melbourne' SA4 region while Marybyrnong lies iside the 'West Melbourne' SA4 Region $$ V = \{Kensington, Racecourse, Industrial, Flemington, Ascot, Footscray, Maribyrnong \} $$

$$ M = \begin{pmatrix} \delta_{H} & \delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} \\ \delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{H} & \delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} \\ \delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\frac{\delta_{H}}{2} &\delta_{H} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} \\ \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{H} & \delta_{A}\cdot\delta_{H} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} \\ \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{H}}{3} & \delta_{A}\cdot\delta_{H} & \delta_{H} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} \\ \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{H} & \delta_{A}\cdot\delta_{H} \\ \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{A}\cdot\frac{\delta_{A}}{2} & \delta_{A}\cdot\delta_{H} & \delta_{H} \\ \end{pmatrix} $$