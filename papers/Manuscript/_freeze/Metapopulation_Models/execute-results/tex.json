{
  "hash": "e17ba96b8c3eeb06d36a8031a6f30df0",
  "result": {
    "markdown": "## Metapopulation Models {#sec-MPMspec}\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Motivation\n\nMulti-patch, 'subdivided' models\n\n-   @wilson1945, @haskey1957\n\n-   Within patch mixing is random, between patch mixing is limited.\n\n-   assumptions @sattenspiel1987\n\n    -   Constant size\n\n        -   equal birth deaths\n\n    -   constant recovery parameter $\\gamma$\n\n    -   No permanent movement of individuals between patches\n\n    -   Disease spread can occur on contact between susceptible individuals\n\n        -   \"the total number of new cases is a proportion, $\\beta$, of the number of contacts\"\n\n        -   \"The number of new cases is a proportion $\\sigma$ of the total number of contacts between susceptible and infective individuals, corrected by a factor a, for differences in population size and density among the groups.\" @sattenspiel1988\n\n    -   Proportionate mixing @sattenspiel1988\n\n        -   \"where the number of encounters is proportional to the size of the subpopulations involved\"\n\n        -   \"The mixing matrices used are chosen to fit known patterns of incidence, rather than on theoretical grounds; and there is no exploration of the importance of variation in the mixing patterns to the transmission of infection through the population.\"\n\nMixing matrix\n\n-   Migration matrix @bodmer1968\n\n    -   \"These models use a backward stochastic migration matrix, in which the elements m, j give the probabilitiesthat the parents of individuals in population i came from population j\"\n\n-   Mixing (contact) matrix @sattenspiel1987\n\n    -   \"the probability of two individuals from different neighborhoods coming into contact. This matrix is a forward stochastic migration matrix, with each element m,,giving the probability that an individual from population i moves topopulation j.\" @sattenspiel1988\n\n## Formulation\n\n### Patches\n\n-   each region $i$ has its own N and $S$ $I$ and $R$ compartments\n\n-   sinlge $\\beta$ and $\\gamma$ values\n\n### Mixing matrix\n\n-   $m_{ij}$represent the probability that a susceptible individual who lives in neighborhood $i$ comes into contact with an infectiveindividual who lives in nieghborhood $j$.\n\n    -   Therefore, $0 \\leq m_{ij} \\leq 1$ and $\\sum_j m_{ij} =1$\n\n    -   M is a stochastic matrix\n\n### Force of infection\n\n@moss2019\n\n-   FOI in region $i$ exerted by infectious individuals who reside in patch$j$ ($\\beta_{ij}$)\n\n    $$\\beta_{ij} = \\beta \\cdot I_j \\cdot M'_{j,i}$$\n\n-   total FOI in patch $i$ ($\\Lambda_i$)\n\n    $$\n    \\Lambda_i = \\sum\\limits_{j =1}^{r}\\beta_{ij}\n    $$\n\n-   and the FOI vector\n\n    $$\n    \\boldsymbol{\\Lambda} = \\beta \\cdot \\boldsymbol{I} \\times M'\n    $$\n\n### Dynamics\n\n$$\n\\begin{aligned}\n\\frac{d S_i}{d t} & =-\\Lambda_i \\cdot \\frac{S_i}{N_i} \\\\\n\\frac{d E_i}{d t} & =\\Lambda_i \\cdot \\frac{S_i}{N_i}-\\sigma E_I \\\\\n\\frac{d I_i}{d t} & =\\sigma E_I-\\gamma I_i \\\\\n\\frac{d R_i}{d t} & =\\gamma I_i\n\\end{aligned}\n$$\n\n@jacquez1988\n\n## Implimentation\n\n-   We impliment the metapopulation model as a CTMC in an analogous way to @sec-SIR_CTMC, but with a few key differences\n\n-   Following @moss2019\n\n### Patches\n\n```         \n-   The GMGCCSA is partitioned into 40 subpopulations, based on the @2023AustralianStatisticalGeographya SA3 classification system.\n\n-   The population of each patch is given in appendix_n and shown in @figGMelbSA3Pop\n```\n\n\n\n::: {.cell caption='Population of SA3 regions in the GMGCCSA'}\n::: {.cell-output-display}\n![](Metapopulation_Models_files/figure-pdf/fig-GMelbSA3Pop-1.pdf){#fig-GMelbSA3Pop}\n:::\n:::\n\n\n\n### Initial conditions\n\n-   At the beginning of a simulation, all patches are composed of entirely susceptivle individuals.\n\n-   a number, $I_0$, of individuals in a randomly selected patch, $\\alpha$, become infected.\n\n-   i.e\n\n$$\n\\begin{aligned}\n\\alpha & \\sim \\mathcal{U}\\{1, r\\} \\\\\nS_i(0) & = \\begin{cases}N_i & \\text { if } i \\neq \\alpha \\\\\nN_i-E_0 & \\text { if } i=\\alpha\\end{cases} \\\\\nE_i(0) & = \\begin{cases}0 & \\text { if } i \\neq \\alpha \\\\\nE_0 & \\text { if } i=\\alpha\\end{cases} \\\\\n R_i(0)=0\n\\end{aligned}\n$$\n\n### Mixing\n\n-   The mixing matrix was defined after @moss2019\n\n-   Empirically informed Origin Destination (OD) matrix\n\n    -   Derived from the 2016 Census data\n\n        -   usual residence X place of work matrix\n\n        -   Determines contact *between regions* but not *within* the region of residence\n\n    -   $$\n        F=\\left(\\begin{array}{cccc}f_{1,1} & f_{1,2} & \\cdots & f_{1, r} \\\\f_{2,1} & f_{2,2} & \\cdots & f_{2, r} \\\\\\vdots & \\vdots & \\ddots & \\vdots \\\\f_{r, 1} & f_{r, 2} & \\cdots & f_{r, r}\\end{array}\\right)\n        $$\n\n    -   $$\n        \\begin{aligned}\n        f_{i, i} & =0 \\\\\n        \\sum_{j=1}^{r} f_{i, j} & =1 \\quad \\forall i \\in[1 . . r]\n        \\end{aligned}$$\n\n-   Within patch mixing is given by a parameter $\\delta^H_i$, the remaining mixing proportion, $\\delta^*_r = 1-\\delta^H_i$ is distributed among the non-local patches $$\n    M=\\left(\\begin{array}{cccc}\n    \\delta_{1}^{H} & \\delta_{1}^{*} f_{1,2} & \\cdots & \\delta_{1}^{*} f_{1, r} \\\\\n    \\delta_{2}^{*} f_{2,1} & \\delta_{2}^{H} & \\cdots & \\delta_{2}^{*} f_{2, r} \\\\\n    \\vdots & \\vdots & \\ddots & \\vdots \\\\\n    \\delta_{r}^{*} f_{r, 1} & \\delta_{r}^{*} f_{r, 2} & \\cdots & \\delta_{r}^{H}\n    \\end{array}\\right)\n    $$\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Metapopulation_Models_files/figure-pdf/unnamed-chunk-3-1.pdf)\n:::\n:::\n\n\n\n### Simulation\n\n-   As per @sec-SIR_sim\n\n-   detlta t will be the sum of exponentially distributed times (expt(sum.rates))\n\n-   State change will involve event type (as in single patch), and event location\n\n    -   State change vector is now 2\\*n patch long\n",
    "supporting": [
      "Metapopulation_Models_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}